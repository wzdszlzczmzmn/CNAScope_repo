"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{19792:function(e,t,n){var r=n(85893),a=n(30441),l=n(58514),o=n(40192),i=n(49227),c=n(67294);t.Z=e=>{let{isShowLeft:t,handleIsShowLeftChange:n,title:s}=e,[d,h]=(0,c.useState)(!1),g=()=>{n(),h(!1)},u=()=>{h(!0)},f=()=>{h(!1)};return(0,r.jsx)(a.Z,{placement:"top",title:"".concat(t?"Close":"Open"," ").concat(s),open:d,children:t?(0,r.jsx)(l.ZP,{shape:"circle",icon:(0,r.jsx)(o.Z,{}),onClick:g,onMouseEnter:u,onMouseLeave:f}):(0,r.jsx)(l.ZP,{shape:"circle",icon:(0,r.jsx)(i.Z,{}),onClick:g,onMouseEnter:u,onMouseLeave:f})})}},73296:function(e,t,n){n.d(t,{Oj:function(){return i}});var r=n(85893),a=n(13368),l=n(67294);let o=(0,l.createContext)({width:0,height:0}),i=()=>(0,l.useContext)(o);t.ZP=e=>{let{containerSx:t,children:n}=e,[i,c]=(0,l.useState)({width:0,height:0}),s=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=s.current,t=new ResizeObserver(e=>{for(let t of e){let{width:e,height:n}=t.contentRect;c({width:e,height:n})}});return e&&t.observe(e),()=>{e&&t.unobserve(e)}},[]),(0,r.jsx)(a.Z,{ref:s,sx:{width:"100%",...t},children:(0,r.jsx)(o.Provider,{value:i,children:n})})}},85417:function(e,t,n){var r=n(85893),a=n(67294),l=n(83074),o=n(61193),i=n.n(o);let c=e=>{let{disabled:t,setDisabled:n,titleContent:a}=e;return(0,r.jsx)("div",{style:{width:"100%",cursor:"move"},onMouseOver:()=>{t&&n(!1)},onMouseOut:()=>{n(!0)},onFocus:()=>{},onBlur:()=>{},children:a})};t.Z=e=>{let{titleContent:t,children:n,...o}=e,[s,d]=(0,a.useState)(!0),[h,g]=(0,a.useState)({left:0,top:0,bottom:0,right:0}),u=(0,a.useRef)(null),f=(e,t)=>{var n;let{clientWidth:r,clientHeight:a}=window.document.documentElement,l=null===(n=u.current)||void 0===n?void 0:n.getBoundingClientRect();l&&g({left:-l.left+t.x,right:r-(l.right-t.x),top:-l.top+t.y,bottom:a-(l.bottom-t.y)})};return(0,r.jsx)(l.Z,{title:(0,r.jsx)(c,{disabled:s,setDisabled:d,titleContent:t}),modalRender:e=>(0,r.jsx)(i(),{disabled:s,bounds:h,nodeRef:u,onStart:(e,t)=>f(e,t),children:(0,r.jsx)("div",{ref:u,children:e})}),zIndex:1200,...o,children:n})}},61080:function(e,t,n){var r=n(85893),a=n(89073),l=n(13368);t.Z=e=>{let{width:t,height:n,containerSx:o,children:i}=e;return(0,r.jsx)(a.Z,{sx:{width:t,height:n,justifyContent:"center",alignItems:"center",...o},children:i||(0,r.jsx)(l.Z,{component:"span",sx:{fontSize:"24px",fontWeight:"500"},children:"A Error Occur!"})})}},79967:function(e,t,n){var r=n(85893),a=n(89073),l=n(70020);t.Z=e=>{let{width:t,height:n,containerSx:o,children:i}=e;return(0,r.jsx)(a.Z,{sx:{width:t,height:n,justifyContent:"center",alignItems:"center",...o},children:i||(0,r.jsx)("div",{style:{width:"100%",textAlign:"center"},children:(0,r.jsx)(l.Z,{tip:"Loading",size:"large",children:(0,r.jsx)("div",{style:{paddingTop:20}})})})})}},72707:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(85893),a=n(13368),l=n(60141),o=n(30441),i=e=>{let{icon:t,tooltipContent:n}=e;return(0,r.jsx)(o.Z,{title:n,children:(0,r.jsx)(a.Z,{component:"span",children:t})})};let c=e=>{let{iconStyle:t}=e;return(0,r.jsx)(l.Z,{style:t})},s=(0,r.jsx)(a.Z,{sx:{wordWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal",hyphens:"auto"},children:"Absolute copy-number profiles adopt a consistent interpretation in which 0 denotes homozygous deletion, 1 indicates loss of heterozygosity (LOH), 2 corresponds to diploid, and values greater than 2 indicate amplifications."}),d=(0,r.jsx)(a.Z,{sx:{wordWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal",hyphens:"auto"},children:"For log2 ratio profiles, values less than 1 indicate deletions, 1 represents normal copy number, and values greater than 1 indicate amplifications."});var h=e=>{let{CNType:t,containerSx:n=null,iconStyle:l=null}=e;return(0,r.jsx)(r.Fragment,{children:"Bin Integer"===t||"Gene Integer"===t?(0,r.jsxs)(a.Z,{component:"span",sx:n,children:["Absolute Scale",(0,r.jsx)(a.Z,{component:"span",sx:{marginLeft:"4px"},children:(0,r.jsx)(i,{icon:(0,r.jsx)(c,{iconStyle:l}),tooltipContent:s})})]}):(0,r.jsxs)(a.Z,{component:"span",sx:n,children:["Log2 Ratio Scale",(0,r.jsx)(a.Z,{component:"span",sx:{marginLeft:"4px"},children:(0,r.jsx)(i,{icon:(0,r.jsx)(c,{iconStyle:l}),tooltipContent:d})})]})})}},4:function(e,t,n){var r=n(85893),a=n(30441);t.Z=e=>{let{text:t,width:n=200}=e;return(0,r.jsx)(a.Z,{title:t,children:(0,r.jsx)("div",{style:{minWidth:"0px",maxWidth:n,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:t||"--"})})}},6011:function(e,t,n){n.d(t,{O:function(){return o}});var r=n(16976),a=n(18244),l=n(38106);let o=(e,t,n)=>{let{data:o,error:i,isLoading:c,mutate:s}=(0,r.ZP)((0,a.OG)(e,t,n),l._);return{genes:o,isGenesLoading:c,isGenesError:i,mutate:s}}},71804:function(e,t,n){n.d(t,{g:function(){return o}});var r=n(16976),a=n(18244),l=n(38106);let o=(e,t,n)=>{let{data:o,error:i,isLoading:c,mutate:s}=(0,r.ZP)((0,a.gS)(e,t,n),l._);return{meta:o,isMetaLoading:c,isMetaError:i,mutate:s}}},89795:function(e,t,n){n.d(t,{I:function(){return o}});var r=n(16976),a=n(18244),l=n(38106);let o=(e,t,n)=>{let{data:o,error:i,isLoading:c,mutate:s}=(0,r.ZP)((0,a.u4)(e,t,n),l._);return{newick:o,isNewickLoading:c,isNewickError:i,mutate:s}}},44299:function(e,t,n){n.d(t,{y:function(){return o}});var r=n(16976),a=n(18244),l=n(38106);let o=(e,t,n)=>{let{data:o,error:i,isLoading:c,mutate:s}=(0,r.ZP)((0,a.vS)(e,t,n),l._);return{terms:o,isTermsLoading:c,isTermsError:i,mutate:s}}},19141:function(e,t,n){n.d(t,{Z:function(){return et}});var r=n(85893),a=n(67294),l=n(22904),o=n(34953),i=n(89073),c=n(13368),s=n(43594),d=n(26163);let h=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsx)(s.e,{title:"Padding Top:",config:t,configKey:n,configSubKey:"paddingTop",handleConfigChange:a})},g=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(i.Z,{spacing:2,children:[(0,r.jsx)(s.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(s.e,{title:"Margin To HeatMap:",config:t,configKey:n,configSubKey:"marginToHeatMap",handleConfigChange:a})]})},u=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(i.Z,{spacing:2,children:[(0,r.jsx)(s.e,{title:"Block Width:",config:t,configKey:n,configSubKey:"blockWidth",handleConfigChange:a}),(0,r.jsx)(s.e,{title:"Block Height:",config:t,configKey:n,configSubKey:"blockHeight",handleConfigChange:a}),(0,r.jsx)(s.e,{title:"Block Gap:",config:t,configKey:n,configSubKey:"blockGap",handleConfigChange:a}),(0,r.jsx)(s.e,{title:"Chromosome Legend Height:",config:t,configKey:n,configSubKey:"chromosomeLegendHeight",handleConfigChange:a})]})},f=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsx)(s.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a})},p=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(i.Z,{spacing:2,children:[(0,r.jsx)(s.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(s.e,{title:"Height:",config:t,configKey:n,configSubKey:"height",handleConfigChange:a})]})},m=(e,t)=>[{key:"chart",label:"Chart Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(h,{config:e,configKey:"chart",handleConfigChange:t})},{key:"tree",label:"Tree Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(g,{config:e,configKey:"tree",handleConfigChange:t})},{key:"heatmap",label:"Heatmap Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(u,{config:e,configKey:"heatmap",handleConfigChange:t})},{key:"meta",label:"Meta Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(f,{config:e,configKey:"meta",handleConfigChange:t})},{key:"nodeHistory",label:"Node History Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(p,{config:e,configKey:"nodeHistory",handleConfigChange:t})}];var x=e=>{let{config:t,handleConfigChange:n}=e,[i,s]=(0,a.useState)(["chart","tree","heatmap"]),d=(0,a.useMemo)(()=>m(t,n),[t,n]);return(0,r.jsxs)(c.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(l.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(o.Z,{items:d,activeKey:i,onChange:e=>{s(e)},size:"middle"})}),(0,r.jsx)(c.Z,{sx:{paddingTop:"12px"}})]})},y=n(33750),j=n(19792),v=n(75757),C=n(11927),b=n(57460),_=n(96486),w=n.n(_),S=n(98400);let A=(e,t)=>{let n=e[0].slice(1,e[0].length),r=e.slice(1,e.length).map(e=>e.map((e,t)=>0===t?e:parseFloat(e))),a={};for(let e=0;e<r.length;e++){let t=r[e];a[t[0]]=t.slice(1,t.length)}let l={};for(let e in t)l[e]=n.slice(parseInt(t[e][0]),parseInt(t[e][1]));return{binIndex:l,CNVMatrixObject:a}},R=e=>/^-?\d+(\.\d+)?$/.test(e),k=["e_PCA1","e_PCA2","e_TSNE1","e_TSNE2","e_UMAP1","e_UMAP2"],Z=e=>{let t=e[0],n=[0,...k.map(e=>t.indexOf(e)).filter(e=>-1!==e)],r=e.map(e=>n.map(t=>e[t])),a=r[0],l=r.slice(1,r.length).map(e=>e.map((e,t)=>R(e)&&"hcluster"!==a[t]?parseFloat(e):e)),o=w().zip(...l),i={};for(let e=1;e<a.length;e++)if("string"==typeof o[e][0])i[a[e]]=[...new Set(o[e])];else{let t=w().ceil(w().max(o[e]),0),n=w().floor(w().min(o[e]),0);i[a[e]]=[-0===n?0:n,-0===t?0:t]}let c={};for(let e=0;e<l.length;e++){let t=l[e];c[t[0]]=t.slice(1,t.length)}return{metaRanges:i,CNVMetaObject:c,metaHeaders:a.slice(1,a.length)}},M=e=>{let t={};for(let n=0;n<e.length;n++)t[e[n][0]]=0===n?[0,e[n][1]]:[t[e[n-1][0]][1],t[e[n-1][0]][1]+e[n][1]];return t},L=(e,t,n,r)=>{let a=JSON.parse(e),{binIndex:l,CNVMatrixObject:o}=A(t=b.parse(t,{skipEmptyLines:!0}).data,r),i=Object.keys(o).length,{metaRanges:c,CNVMetaObject:s,metaHeaders:d}=Z(n=b.parse(n,{skipEmptyLines:!0}).data);return{CNVCutObject:a,binIndex:l,CNVMatrixObject:o,totalFileNum:i,metaRanges:c,CNVMetaObject:s,metaHeaders:d}},N=(e,t)=>{let n=[["chr1",0,t*e[0][1]]];for(let r=1;r<e.length;r++)n.push([e[r][0],e[r-1][1]*t+n[r-1][1],t*e[r][1]]);return n},T=(e,t)=>{let n=C.bT9((0,S.Z)(e),e=>e.children).sum(e=>e.children?0:1).children[0],r=t/(n.height+1),a=C.ki8().nodeSize([10,r]);return n.sort((e,t)=>C.j2p(e.data.name,t.data.name)),a(n),n},P=(e,t)=>{let n=t.leaves(),r={};for(let t of n)r[t.data.name]=e[t.data.name].leafs;return r},I=(e,t,n)=>{let r={};for(let a of Object.keys(t)){let l=Object.values(w().pick(e,t[a])),o=w().zip(...l).map(e=>w().mean(e)),i={};for(let e in n)i[e]=o.slice(n[e][0],n[e][1]);r[a]={fileNum:l.length,CNVAvg:i}}let a=Object.keys(r);for(let e=0;e<a.length;e++)r[a[e]].offset=0===e?0:r[a[e-1]].offset+r[a[e-1]].fileNum;return r},H=(e,t)=>{let n={};for(let r of Object.keys(t))n[r]=w().pick(e,t[r]);return n},E=(e,t,n)=>{let r={},a=Object.keys(t);for(let e=0;e<a.length;e++)r[e]=0===e?0:t[a[e-1]].length+r[e-1];let l=e.leaves();for(let e=0;e<l.length;e++)l[e].x=(r[e]+t[a[e]].length/2)*n;for(let t of e.descendants().reverse())t.children&&(t.x=(t.children[1].x+t.children[0].x)/2)},z=(e,t)=>{let n;n=0===t?[-1,1]:[0,10];let r=C.cJy().domain([n[0],t]).interpolator(C.LX0("#add8e6","#ffffff")).clamp(!0),a=C.cJy().domain([t,n[1]]).interpolator(C.LX0("#ffffff","#6A0220")).clamp(!0),l=C.cJy().domain(e.e_PCA1).interpolator(C.LX0("#c4a1d3","#ad49e1")),o=C.cJy().domain(e.e_PCA2).interpolator(C.LX0("#52b199","#0d7c66")),i=C.cJy().domain(e.e_TSNE1||[0,1]).interpolator(C.LX0("#d88f92","#c63c51")),c={CNVLow:r,CNVHigh:a,e_PCA1:l,e_PCA2:o,e_TSNE1:i,e_TSNE2:C.cJy().domain(e.e_TSNE2||[0,1]).interpolator(C.LX0("#bad9ff","#3572ef")),e_UMAP1:C.cJy().domain(e.e_UMAP1).interpolator(C.LX0("#ffa699","#ff7f3e")),e_UMAP2:C.cJy().domain(e.e_UMAP2).interpolator(C.LX0("#f0e8fa","#FF76CE"))};return{colorScales:c,getCNVColor:e=>e<t?c.CNVLow(e):c.CNVHigh(e)}};var F=n(17028),W=e=>{let t,{width:n,marginTop:a,legendWidth:l,legendHeight:o,colorScales:i,baselineCNA:c}=e;t=0===c?[-1,1]:[0,10];let s=C.PUr([t[0],c,t[1]],["#add8e6","#ffffff","#6A0220"]);return(0,r.jsxs)("g",{transform:"translate(".concat((n-l)/2,", ").concat(a,")"),children:[(0,r.jsx)(F.n,{color:s,title:"CNV Value",width:l,legendMarginTop:0,ticks:t[1]-t[0]+1}),(0,r.jsx)(F.n,{color:i.e_PCA1,title:"ePCA1",width:l,legendMarginTop:1*o}),(0,r.jsx)(F.n,{color:i.e_PCA2,title:"ePCA2",width:l,legendMarginTop:2*o}),(0,r.jsx)(F.n,{color:i.e_TSNE1,title:"e_TSNE1",width:l,legendMarginTop:3*o}),(0,r.jsx)(F.n,{color:i.e_TSNE2,title:"e_TSNE2",width:l,legendMarginTop:4*o}),(0,r.jsx)(F.n,{color:i.e_UMAP1,title:"e_UMAP1",width:l,legendMarginTop:5*o}),(0,r.jsx)(F.n,{color:i.e_UMAP2,title:"e_UMAP2",width:l,legendMarginTop:6*o})]})},Y=n(73935),B=n(65420),O=n(69984),K=n(77225);let U=e=>{e.attr("opacity",.1)},V=e=>{e.attr("opacity",1)};var G=e=>{let{marginLeft:t,paddingTop:n,width:l,root:o,CNVCut:i,goToTreeNode:c,showTooltip:s,hideTooltip:d}=e,h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=C.Ys(h.current),t=C.Ys(".heatMapContainer");(0,O.Au)(o,o.data.length=0,l/(0,O.w6)(o));let n=e.select(".links");n.empty()&&(n=e.append("g").attr("class","links").attr("fill","none").attr("stroke","#000000"));let r=e.select(".nodes");r.empty()&&(r=e.append("g").attr("class","nodes").attr("cursor","pointer").attr("pointer-events","all")),n.selectAll("path").data(o.links()).join("path").attr("d",O.UH),r.selectAll("g").data(o.descendants(),e=>e.data.name).join(e=>{e.append("g").attr("transform",O.Y9).append("circle").attr("r",4).each(function(e){let n=e.data.name,r=i[n];e.children?C.Ys(this).on("mouseenter",e=>{s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))}).on("mouseout",()=>{d()}).on("mousemove",e=>s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))):C.Ys(this).on("mouseenter",e=>{U(t.selectAll(".chromosome").filter(e=>e!==n)),s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))}).on("mouseout",()=>{d(),V(t.selectAll(".chromosome").filter(e=>e!==n))}).on("mousemove",e=>s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))),1===i[e.data.name].leafs.length?C.Ys(this).attr("fill","#999"):C.Ys(this).attr("fill","#333").on("click",function(e,t){c(t.data.name)})})},e=>{e.attr("transform",O.Y9).each(function(e){let n=e.data.name,r=i[n];e.children?C.Ys(this).on("mouseenter",e=>{s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))}).on("mouseout",()=>{d()}).on("mousemove",e=>s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))):C.Ys(this).on("mouseenter",e=>{U(t.selectAll(".chromosome").filter(e=>e!==n)),s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))}).on("mouseout",()=>{d(),V(t.selectAll(".chromosome").filter(e=>e!==n))}).on("mousemove",e=>s(e,(0,K.R6)(n,r.parent,r.leafs.length,r.dist_to_root))),1===i[e.data.name].leafs.length?C.Ys(this).select("circle").attr("fill","#999"):C.Ys(this).select("circle").attr("fill","#333").on("click",function(e,r){V(t.selectAll(".chromosome").filter(e=>e!==n)),c(r.data.name)})})},e=>{e.transition().duration(500).attr("fill-opacity",0).remove()})},[i,c,d,o,s,l]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("g",{ref:h,transform:"translate(".concat(t,", ").concat(n,")")})})};let X=(e,t,n,r,a,l,o,i,c)=>{let s=r*a*4,d=n.selectAll(".chromosome").selectAll("g"),h=d.filter(function(t){return t===e}),g=d.filter(function(e){return t.includes(e)}),u=i.selectAll("g").filter(function(e){return t.includes(e[0])});parseFloat(h.select("rect").attr("width"))!==a-c?(g.each(function(){let e=parseFloat(C.Ys(this).attr("transform").match(/translate\(([\d.]+), 0\)/)[1]);C.Ys(this).attr("transform","translate(".concat(e-s,", 0)"))}),h.selectAll("rect").attr("width",a-c).attr("x",(e,t)=>t*a),C.Ys(o).select("rect").attr("width",r*a),C.Ys(o).select("text").attr("x",r*a/2),u.each(function(){let e=parseFloat(C.Ys(this).attr("transform").match(/translate\(([\d.]+), 0\)/)[1]);C.Ys(this).attr("transform","translate(".concat(e-s,", 0)"))})):(g.each(function(){let e=parseFloat(C.Ys(this).attr("transform").match(/translate\(([\d.]+), 0\)/)[1]);C.Ys(this).attr("transform","translate(".concat(e+s,", 0)"))}),h.selectAll("rect").attr("width",5*a-c).attr("x",(e,t)=>5*t*a),C.Ys(o).select("rect").attr("width",5*r*a),C.Ys(o).select("text").attr("x",5*r*a/2),u.each(function(){let e=parseFloat(C.Ys(this).attr("transform").match(/translate\(([\d.]+), 0\)/)[1]);C.Ys(this).attr("transform","translate(".concat(e+s,", 0)"))}))};var D=e=>{let{marginLeft:t,paddingTop:n,metaOffset:l,chromosomeLegendHeight:o,blockWidth:i,blockGap:c,metaWidth:s,headerBlockOffset:d,CNVMatrixMeta:h,metaHeaders:g,showTooltip:u,hideTooltip:f}=e,p=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=C.Ys(p.current),t=C.Ys(".heatMapContainer"),n=h.map(e=>e[0]),r=h.map(e=>e[1]),a=e.select(".chromosomeHeader");a.empty()&&(a=e.append("g").attr("class","chromosomeHeader")),a.selectAll("g").data(d).join(e=>{a.attr("transform","translate(".concat(l,", 0)"));let s=e.append("g").attr("transform",e=>"translate(".concat(e[1],", 0)"));s.append("rect").attr("width",e=>e[2]).attr("height",o).attr("fill",(e,t)=>t%2==0?"#c6c6c6":"#303030").attr("cursor","pointer").attr("pointer-events","all").each(function(e){let t=w().replace(e[0],"chr","Chromosome");C.Ys(this).on("mouseenter",e=>u(e,(0,K.X9)(t))).on("mousemove",e=>u(e,(0,K.X9)(t))).on("mouseout",f)}).on("click",function(e,l){let o=l[0],s=n.slice(n.indexOf(o)+1,n.length),d=r[n.indexOf(o)];X(o,s,t,d,i,l,this.parentNode,a,c)}),s.append("text").attr("x",e=>e[2]/2).attr("y",o/2).attr("pointer-events","none").attr("text-anchor","middle").attr("dy",".35em").text(e=>e[0].slice(3,e[0].length)).attr("fill",(e,t)=>t%2==0?"#000000":"#ffffff")},e=>{a.attr("transform","translate(".concat(l,", 0)")),e.each(function(){let e=C.Ys(this).attr("transform",e=>"translate(".concat(e[1],", 0)"));e.select("rect").attr("width",e=>e[2]).attr("height",o).on("click",function(e,l){let o=l[0],s=n.slice(n.indexOf(o)+1,n.length),d=r[n.indexOf(o)];X(o,s,t,d,i,l,this.parentNode,a,c)}),e.select("text").attr("x",e=>e[2]/2).attr("y",o/2)})});let m=e.select(".metaHeader");m.empty()?m=e.append("g").attr("class","metaHeader").attr("transform","translate(0, ".concat(o,")")):m.attr("transform","translate(0, ".concat(o,")")),m.selectAll("text").data(g).join(e=>{e.append("text").attr("dy","0.3em").attr("font-size","12").attr("font-family","sans-serif").attr("transform",(e,t)=>"rotate(-90) translate(4, ".concat(s*t,")")).text(e=>e.split("_").pop())},e=>{m.selectAll("text").attr("transform",(e,t)=>"rotate(-90) translate(4, ".concat(s*t+s/2,")"))})},[h,c,i,o,d,f,g,l,s,u]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("g",{ref:p,transform:"translate(".concat(t,", ").concat(n,")")})})},q=e=>{let{marginLeft:t,paddingTop:n,blockHeight:l,blockWidth:o,metaWidth:i,metaOffset:c,colorScales:s,blockGap:d,leaves:h,CNVClusterMeanMatrix:g,clusterMetaDict:u,metaNameList:f,headerBlockOffset:p,binIndex:m,getCNVColor:x,showTooltip:y,hideTooltip:j}=e,v=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=C.Ys(v.current).selectAll(":scope > g").data(h).join("g").attr("transform",e=>"translate(0, ".concat(g[e].offset*l,")"));e.each(function(e){let t=C.Ys(this).select(".metaInfo");t.empty()&&(t=C.Ys(this).append("g").attr("class","metaInfo")),t.selectAll("g").data(Object.keys(u[e])).join("g").attr("transform",(e,t)=>"translate(0, ".concat(t*l,")")).each(function(t){C.Ys(this).selectAll("rect").data(t=>u[e][t]).join("rect").attr("x",(e,t)=>i*t).attr("width",i-d).attr("height",l-d).attr("fill",(e,t)=>s[f[t]](e)).each(function(e,n){C.Ys(this).on("mouseenter",r=>y(r,(0,K.xE)(t,s[f[n]](e),f[n],e))).on("mousemove",r=>y(r,(0,K.xE)(t,s[f[n]](e),f[n],e))).on("mouseout",j)})})}),e.each(function(e){let t=g[e],n=t.fileNum,r=C.Ys(this).select(".chromosome");r.empty()&&(r=C.Ys(this).append("g").attr("class","chromosome")),r.selectAll("g").data(Object.keys(t.CNVAvg)).join("g").attr("transform",(e,t)=>"translate(".concat(c+p[t][1],", 0)")).each(function(r){C.Ys(this).selectAll("rect").data(t.CNVAvg[r]).join("rect").each(function(t,a){C.Ys(this).attr("x",a*o).attr("width",o-d).attr("height",l*n-d).attr("fill",e=>x(e)).on("mouseenter",n=>y(n,(0,K.xE)(e,x(t),m[r][a],t))).on("mousemove",n=>y(n,(0,K.xE)(e,x(t),m[r][a],t))).on("mouseout",j)})})})},[g,m,d,l,o,u,s,x,p,j,h,t,f,c,i,y]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("g",{ref:v,transform:"translate(".concat(t,", ").concat(n,")"),className:"heatMapContainer"})})},$=e=>{let{buttonWidth:t,buttonHeight:n,marginLeft:a,paddingTop:l,currentNodeIndex:o,nodeHistoryList:i,goBackRoot:c,goForwardNode:s,goBackNode:d}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("g",{transform:"translate(".concat(a,", ").concat(l,")"),children:[(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",{width:2*t+4,height:n,fill:0===o?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:0===o?"not-allowed":"pointer",onClick:0===o?null:c}),(0,r.jsx)("text",{fontSize:10,x:t+2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Back To Root"})]}),(0,r.jsxs)("g",{transform:"translate(0, ".concat(n+4,")"),children:[(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",{width:t,height:n,fill:0===o?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:0===o?"not-allowed":"pointer",onClick:0===o?null:d}),(0,r.jsx)("text",{fontSize:10,x:t/2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Prev"})]}),(0,r.jsxs)("g",{transform:"translate(".concat(t+4,", 0)"),children:[(0,r.jsx)("rect",{width:t,height:n,fill:o===i.length-1?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:o===i.length-1?"not-allowed":"pointer",onClick:o===i.length-1?null:s}),(0,r.jsx)("text",{fontSize:10,x:t/2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Next"})]})]})]})})},J=n(9040);let Q=(0,a.forwardRef)((e,t)=>{let{matrix:n,meta:l,tree:o,baselineCNA:i,reference:s,binStep:d=5e6,config:h,isShowLeft:g,handleIsShowLeftChange:u}=e,f=(0,a.useRef)(null),p=(0,a.useRef)(null),m=(0,a.useRef)(null),[x,y]=(0,a.useState)(["n0"]),[b,_]=(0,a.useState)(0),w=(0,v.OE)(d,s),S=M(w),A=(0,a.useMemo)(()=>L(o,n,l,S),[S,n,l,o]),R=(0,a.useMemo)(()=>N(w,h.heatmap.blockWidth),[w,h.heatmap.blockWidth]),{colorScales:k,getCNVColor:Z}=z(A.metaRanges,i),F=h.meta.width*Object.values(A.CNVMetaObject)[0].length,O=T(A.CNVCutObject[x[b]].newick,h.tree.width),K=P(A.CNVCutObject,O),U=I(A.CNVMatrixObject,K,S);Object.values(U).reduce((e,t)=>e+t.fileNum,0);let V=O.leaves().map(e=>e.data.name),X=H(A.CNVMetaObject,K);E(O,K,h.heatmap.blockHeight);let Q=(e,t)=>{m.current.showTooltip(e,t)},ee=()=>{m.current.hideTooltip()};return(0,a.useEffect)(()=>{let e=C.sPX().scaleExtent([.1,10]).on("zoom",function(e){C.Ys(p.current).attr("transform",e.transform)});C.Ys(f.current).call(e)},[]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{f.current&&(0,J.X)(f.current,"Bin-Level_CNA_Heatmap.svg")}})),(0,r.jsxs)(c.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(c.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(j.Z,{isShowLeft:g,handleIsShowLeftChange:u,title:"Setting Options"})}),(0,r.jsx)("svg",{ref:f,width:"100%",height:"100%",children:(0,r.jsxs)("g",{ref:p,children:[(0,r.jsx)(W,{width:h.legend.width,marginTop:h.legend.marginTop,legendWidth:h.legend.legendWidth,legendHeight:h.legend.legendHeight,colorScales:k,baselineCNA:i}),(0,r.jsx)(q,{marginLeft:h.tree.width+h.tree.marginToHeatMap+h.legend.width,paddingTop:h.chart.paddingTop+h.heatmap.chromosomeLegendHeight,blockHeight:h.heatmap.blockHeight,blockWidth:h.heatmap.blockWidth,metaWidth:h.meta.width,metaOffset:F,colorScales:k,blockGap:h.heatmap.blockGap,leaves:V,CNVClusterMeanMatrix:U,clusterMetaDict:X,metaNameList:A.metaHeaders,headerBlockOffset:R,binIndex:A.binIndex,getCNVColor:Z,showTooltip:Q,hideTooltip:ee}),(0,r.jsx)($,{buttonWidth:h.nodeHistory.width,buttonHeight:h.nodeHistory.height,marginLeft:.85*h.tree.width-2*h.nodeHistory.width+h.legend.width,paddingTop:h.chart.paddingTop+h.heatmap.chromosomeLegendHeight-2*h.nodeHistory.height-4,currentNodeIndex:b,nodeHistoryList:x,goBackNode:()=>{b>0&&_(b-1)},goForwardNode:()=>{b<x.length-1&&_(b+1)},goBackRoot:()=>{y(["n0"]),_(0)}}),(0,r.jsx)(G,{marginLeft:h.legend.width,paddingTop:h.chart.paddingTop+h.heatmap.chromosomeLegendHeight,width:h.tree.width,root:O,CNVCut:A.CNVCutObject,goToTreeNode:e=>{y([...x.slice(0,b+1),e]),_(b+1)},showTooltip:Q,hideTooltip:ee}),(0,r.jsx)(D,{marginLeft:h.tree.width+h.tree.marginToHeatMap+h.legend.width,paddingTop:h.chart.paddingTop,metaOffset:F,chromosomeLegendHeight:h.heatmap.chromosomeLegendHeight,blockWidth:h.heatmap.blockWidth,blockGap:h.heatmap.blockGap,metaWidth:h.meta.width,headerBlockOffset:R,CNVMatrixMeta:w,metaHeaders:A.metaHeaders,showTooltip:Q,hideTooltip:ee})]})}),(0,Y.createPortal)((0,r.jsx)(B.Z,{ref:m}),document.body)]})});Q.displayName="CNAChromosomeHeatmapPanel";let ee={"5M":5e6,"500kb":5e5,"200kb":2e5};var et=e=>{let{matrix:t,meta:n,tree:l,baselineCNA:o,reference:i,binSize:c,vizRef:s}=e,[d,h]=(0,a.useState)(!0),[g,u]=(0,a.useState)({chart:{paddingTop:40},tree:{width:300,marginToHeatMap:20},heatmap:{blockWidth:2,defaultHeight:6,blockHeight:10,blockGap:.1,chromosomeLegendHeight:25},meta:{width:16},nodeHistory:{width:35,height:20},legend:{marginTop:50,width:350,legendWidth:250,legendHeight:45}}),f=(e,t,n)=>{u(r=>({...r,[e]:{...r[e],[t]:n}}))};return(0,a.useEffect)(()=>{"5M"===c?(f("heatmap","blockWidth",2),f("heatmap","blockGap",.1)):"500kb"===c?(f("heatmap","blockWidth",.5),f("heatmap","blockGap",0)):"200kb"===c&&(f("heatmap","blockWidth",.1),f("heatmap","blockGap",0))},[c]),(0,r.jsx)(y.Z,{isShowLeft:d,leftPanelWidth:300,leftPanel:(0,r.jsx)(x,{config:g,handleConfigChange:f}),rightPanel:(0,r.jsx)(Q,{matrix:t,meta:n,tree:l,baselineCNA:o,reference:i,config:g,isShowLeft:d,handleIsShowLeftChange:()=>{h(!d)},binStep:ee[c],ref:s})})}},96413:function(e,t,n){n.d(t,{Hl:function(){return v},Ir:function(){return x},W0:function(){return y},d0:function(){return C},fJ:function(){return j},yB:function(){return p}});var r=n(85893),a=n(67294),l=n(93870),o=n(26163),i=n(13368),c=n(89073),s=n(2492),d=n(46833),h=n(58514),g=n(22904),u=n(34953),f=n(43594);let p=[{value:"cluster",label:"Cluster"},{value:"bin",label:"Bin"},{value:"gene",label:"Gene"},{value:"term",label:"Term"}],m=Array.from({length:9}).map((e,t)=>({value:t+2,label:t+2})),x=e=>{let{colorOptions:t,handleColorOptionsChange:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Cluster:"}),(0,r.jsx)(s.default,{value:t.cluster,onChange:e=>n("cluster",e),options:m,style:{width:"240px"},size:"large"})]})},y=e=>{let{bins:t,binValue:n,onBinValueChange:a,handleColorOptionsChange:l}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Bin:"}),(0,r.jsx)(d.Z,{value:n,onSelect:(e,t)=>l("bin",t),onChange:a,options:t,filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase()),style:{width:"240px"}})]})},j=e=>{let{genes:t,geneValue:n,onGeneValueChange:a,handleColorOptionsChange:l}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Selected Gene:"}),(0,r.jsx)(d.Z,{value:n,onSelect:(e,t)=>l("gene",t),onChange:a,options:t,filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase()),style:{width:"240px"}})]})},v=e=>{let{terms:t,termValue:n,onTermValueChange:a,handleColorOptionsChange:l}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Selected Term:"}),(0,r.jsx)(d.Z,{value:n,onSelect:(e,t)=>l("term",t),onChange:a,options:t,filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase()),popupMatchSelectWidth:750,style:{width:"240px"}})]})},C=e=>{let{onRender:t,resetRenderData:n}=e;return(0,r.jsxs)(c.Z,{direction:"row",sx:{justifyContent:"space-between"},children:[(0,r.jsx)(h.ZP,{style:{width:"110px",backgroundColor:"#41B3A2",color:"#FFFFFF",borderColor:"#41B3A2"},onClick:t,children:"Render"}),(0,r.jsx)(h.ZP,{style:{width:"110px",color:"#41B3A2",borderColor:"#41B3A2"},onClick:n,children:"Reset"})]})},b=e=>{let{bins:t,genes:n,terms:l,embeddingMethod:o,handleEmbeddingMethodChange:d,colorOptions:g,handleColorOptionsChange:u,onRender:f,resetRenderData:m,metaFieldOptions:b,showModal:_}=e,[w,S]=(0,a.useState)(""),[A,R]=(0,a.useState)(""),[k,Z]=(0,a.useState)("");(0,a.useEffect)(()=>{g.bin&&S(g.bin)},[g.bin]),(0,a.useEffect)(()=>{g.gene&&R(g.gene)},[g.gene]),(0,a.useEffect)(()=>{g.term&&Z(g.term)},[g.term]);let M={cluster:(0,r.jsx)(x,{colorOptions:g,handleColorOptionsChange:u}),bin:(0,r.jsx)(y,{bins:t,binValue:w,onBinValueChange:e=>{S(e)},handleColorOptionsChange:u}),gene:(0,r.jsx)(j,{genes:n,geneValue:A,onGeneValueChange:e=>{R(e)},handleColorOptionsChange:u}),term:(0,r.jsx)(v,{terms:l,termValue:k,onTermValueChange:e=>{Z(e)},handleColorOptionsChange:u})};return(0,r.jsxs)(c.Z,{spacing:3,children:[(0,r.jsxs)(c.Z,{spacing:1,children:[(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Embedding Method:"}),(0,r.jsx)(s.default,{value:o,onChange:d,options:b,style:{width:"240px"},size:"large"}),(0,r.jsx)(i.Z,{sx:{fontWeight:500},children:"Color By:"}),(0,r.jsx)(s.default,{value:g.colorBy,onChange:e=>u("colorBy",e),options:p,style:{width:"240px"},size:"large"}),M[g.colorBy]]}),(0,r.jsxs)(c.Z,{spacing:1,sx:{mt:3,mb:2},children:[(0,r.jsx)(C,{onRender:f,resetRenderData:m}),"cluster"===g.colorBy?(0,r.jsx)(h.ZP,{style:{backgroundColor:"#41B3A2",color:"#FFFFFF",borderColor:"#41B3A2"},onClick:_,children:"View Cluster Info"}):(0,r.jsx)(r.Fragment,{})]})]})},_=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(c.Z,{spacing:2,children:[(0,r.jsx)(f.e,{title:"Margin:",config:t,configKey:n,configSubKey:"margin",handleConfigChange:a}),(0,r.jsx)(f.e,{title:"Axis Width:",config:t,configKey:n,configSubKey:"axisWidth",handleConfigChange:a})]})},w=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsx)(f.e,{title:"Radius:",config:t,configKey:n,configSubKey:"radius",handleConfigChange:a})},S=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(c.Z,{spacing:2,children:[(0,r.jsx)(f.e,{title:"Margin Top:",config:t,configKey:n,configSubKey:"marginTop",handleConfigChange:a}),(0,r.jsx)(f.e,{title:"Margin Bottom:",config:t,configKey:n,configSubKey:"marginBottom",handleConfigChange:a}),(0,r.jsx)(f.e,{title:"Font Size:",config:t,configKey:n,configSubKey:"fontSize",handleConfigChange:a})]})},A=(e,t,n,a,i,c,s,d,h,g,u,f,p)=>[{key:"data",label:"Data Setting",extra:(0,r.jsx)(l.Z,{}),children:(0,r.jsx)(b,{bins:e,genes:t,terms:n,embeddingMethod:c,handleEmbeddingMethodChange:s,colorOptions:d,handleColorOptionsChange:h,onRender:g,resetRenderData:u,metaFieldOptions:f,showModal:p})},{key:"chart",label:"Chart Setting",extra:(0,r.jsx)(o.Z,{}),children:(0,r.jsx)(_,{config:a,configKey:"chart",handleConfigChange:i})},{key:"scatter",label:"Scatter Setting",extra:(0,r.jsx)(o.Z,{}),children:(0,r.jsx)(w,{config:a,configKey:"scatter",handleConfigChange:i})},{key:"title",label:"Title Setting",extra:(0,r.jsx)(o.Z,{}),children:(0,r.jsx)(S,{config:a,configKey:"title",handleConfigChange:i})}];t.ZP=e=>{let{bins:t,genes:n,terms:l,embeddingMethod:o,handleEmbeddingMethodChange:c,colorOptions:s,handleColorOptionsChange:d,config:h,handleConfigChange:f,onRender:p,resetRenderData:m,metaFieldOptions:x,showModal:y}=e,[j,v]=(0,a.useState)(["data","chart"]),C=(0,a.useMemo)(()=>A(t,n,l,h,f,o,c,s,d,p,m,x,y),[t,n,l,h,f,o,c,s,d,p,m,x,y]);return(0,r.jsxs)(i.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(g.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(u.Z,{items:C,activeKey:j,onChange:e=>{v(e)},size:"middle"})}),(0,r.jsx)(i.Z,{sx:{paddingTop:"12px"}})]})}},91076:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(85893),a=n(67294),l=n(33750),o=n(96413),i=n(11927),c=n(21333),s=n(89073),d=n(58557),h=n(73935),g=n(65420),u=n(9040);let f=(0,a.forwardRef)((e,t)=>{let{embeddingMethod:n,cluster:l,meta:o,extents:d,config:f}=e,j=(0,a.useRef)(null),v=(0,a.useRef)(null),C=(0,a.useRef)(null),b=(0,a.useRef)(null),_=(0,a.useRef)(null),w=(0,a.useRef)(null),{svgWidth:S,svgHeight:A,innerWidth:R,figureSize:k,rowLegendNum:Z,xOffsetScatterPlot:M,yOffsetScatterPlot:L,yOffsetXAxis:N,xOffsetLegend:T,yOffsetLegend:P,xRange:I,yRange:H,colorScale:E}=(0,c.jU)(920,l,f),z=(0,c.$R)(n,d),{x:F,y:W}=(0,c.yX)(z,I,H);return(0,a.useEffect)(()=>{i.Ys(C.current).call(i.LLu(F))},[F]),(0,a.useEffect)(()=>{i.Ys(b.current).call(i.y4O(W))},[W]),(0,a.useEffect)(()=>{i.Ys(_.current).selectAll("g").data(Array.from({length:l},(e,t)=>t+1)).join("g").attr("class",e=>"cluster".concat(e)).each(function(e){i.Ys(this).selectAll("circle").data(o.filter(t=>t.cluster===e),e=>e.id).join("circle").attr("cx",e=>F(e["".concat(n,"1")])).attr("cy",e=>W(e["".concat(n,"2")])).attr("r",f.scatter.radius).attr("fill",E(e)).on("pointerenter pointermove",(e,t)=>x(e,t.id,[t["".concat(n,"1")],t["".concat(n,"2")]],"rgba(30, 144, 255, 0.6)",v)).on("pointerleave",()=>y(v))})},[l,E,f.scatter.radius,n,o,F,W]),(0,a.useEffect)(()=>{i.Ys(w.current).selectAll("g").data(Array.from({length:l},(e,t)=>t+1)).join("g").attr("transform",(e,t)=>"translate(".concat(Math.floor(t/Z)*(f.legend.width+f.legend.itemHorizontalGap),", ").concat((f.legend.itemVerticalGap+f.legend.height)*(t%Z),")")).each(function(e){let t=i.Ys(this);t.selectAll("rect").data([e]).join("rect").attr("y",2).attr("width",26).attr("height",16).attr("rx",4).attr("ry",4).attr("fill",E(e)),t.selectAll("text").data([e]).join("text").attr("x",30).attr("dy","1rem").text(e=>"Cluster ".concat(e)),t.selectAll(".legend-event-trigger").data([e]).join("rect").attr("class","legend-event-trigger").attr("width",f.legend.width).attr("height",f.legend.height).attr("fill","transparent").on("pointerenter pointermove",(e,t)=>p(t,_)).on("pointerleave",(e,t)=>m(t,_))})},[l,E,f.legend.height,f.legend.itemHorizontalGap,f.legend.itemVerticalGap,f.legend.width,Z]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{j.current&&(0,u.X)(j.current,"".concat(n.slice(2),"_Embedding_Map.svg"))}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{sx:{alignItems:"center",overflowX:"auto"},children:(0,r.jsx)("svg",{ref:j,width:S,height:A,children:(0,r.jsxs)("g",{className:"plotContainer",transform:"translate(".concat(f.chart.margin,", ").concat(f.chart.margin,")"),children:[(0,r.jsx)("g",{className:"title",children:(0,r.jsxs)("text",{fontSize:f.title.fontSize,transform:"translate(".concat(S/2,", ").concat(f.title.marginTop,")"),dy:"1em",textAnchor:"middle",fontWeight:500,children:[n.slice(2)," Embedding Map"]})}),(0,r.jsx)("g",{ref:C,transform:"translate(".concat(M,", ").concat(N,")"),children:(0,r.jsxs)("text",{x:k/2,y:36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",children:[n.slice(2),"1"]})}),(0,r.jsx)("g",{ref:b,transform:"translate(".concat(M,", ").concat(L,")"),children:(0,r.jsxs)("text",{y:k/2+36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",transform:"rotate(90, 0, ".concat(k/2,")"),children:[n.slice(2),"2"]})}),(0,r.jsx)("g",{ref:_,transform:"translate(".concat(M,", ").concat(L,")")}),(0,r.jsx)("g",{ref:w,transform:"translate(".concat(T,", ").concat(P,")")})]})})}),(0,h.createPortal)((0,r.jsx)(g.Z,{ref:v}),document.body)]})}),p=(e,t)=>{i.Ys(t.current).selectAll("g:not(.cluster".concat(e,")")).attr("opacity",.2)},m=(e,t)=>{i.Ys(t.current).selectAll("g").attr("opacity",1)},x=(e,t,n,r,a)=>{a.current.showTooltip(e,(0,d.d)(t,n,r))},y=e=>{e.current.hideTooltip()};f.displayName="EmbeddingMapPanel";var j=n(13368),v=n(19792),C=n(2755),b=n(79967),_=n(17028),w=n(96486),S=n.n(w);let A=(0,a.forwardRef)((e,t)=>{let{embeddingMethod:n,extents:l,meta:o,gene:d,genes:f,config:p,isLog:m}=e,x=(0,a.useRef)(null),y=(0,a.useRef)(null),j=(0,a.useRef)(null),v=(0,a.useRef)(null),C=(0,a.useRef)(null),{svgWidth:b,svgHeight:w,innerWidth:A,figureSize:Z,subTitleMarginTop:M,xOffsetScatterPlot:L,yOffsetScatterPlot:N,yOffsetXAxis:T,xOffsetLegend:P,yOffsetLegend:I,xRange:H,yRange:E,CNARange:z,CNAValueScale:F}=(0,c.lY)(920,p,m),W=(0,c.$R)(n,l),{x:Y,y:B}=(0,c.yX)(W,H,E);return(0,a.useEffect)(()=>{i.Ys(j.current).call(i.LLu(Y))},[Y]),(0,a.useEffect)(()=>{i.Ys(v.current).call(i.y4O(B))},[B]),(0,a.useEffect)(()=>{i.Ys(C.current).selectAll("circle").data(o,e=>e.id).join("circle").attr("cx",e=>Y(e["".concat(n,"1")])).attr("cy",e=>B(e["".concat(n,"2")])).attr("r",p.scatter.radius).attr("fill",e=>F(f[e.id])).on("pointerenter pointermove",(e,t)=>R(e,t.id,[t["".concat(n,"1")],t["".concat(n,"2")]],f[t.id],y)).on("pointerleave",()=>k(y))},[F,p.scatter.radius,n,f,o,Y,B]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{x.current&&(0,u.X)(x.current,"".concat(n.slice(2),"_Embedding_Map.svg"))}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{sx:{alignItems:"center",overflowX:"auto"},children:(0,r.jsx)("svg",{ref:x,width:b,height:w,children:(0,r.jsxs)("g",{className:"plotContainer",transform:"translate(".concat(p.chart.margin,", ").concat(p.chart.margin,")"),children:[(0,r.jsxs)("g",{className:"title",children:[(0,r.jsxs)("text",{fontSize:p.title.fontSize,transform:"translate(".concat(b/2,", ").concat(p.title.marginTop,")"),dy:"1em",textAnchor:"middle",fontWeight:500,children:[n.slice(2)," Embedding Map"]}),(0,r.jsxs)("text",{fontSize:p.title.subFontSize,transform:"translate(".concat(b/2,", ").concat(M,")"),dy:"1em",textAnchor:"middle",fontWeight:500,fill:"#B0B0B0",children:[(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Color By: "}),(0,r.jsxs)("tspan",{children:["Gene (",d.value,")\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"]}),(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Variance: "}),(0,r.jsx)("tspan",{children:S().round(d.variance,3)})]})]}),(0,r.jsx)("g",{ref:j,transform:"translate(".concat(L,", ").concat(T,")"),children:(0,r.jsxs)("text",{x:Z/2,y:36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",children:[n.slice(2),"1"]})}),(0,r.jsx)("g",{ref:v,transform:"translate(".concat(L,", ").concat(N,")"),children:(0,r.jsxs)("text",{y:Z/2+36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",transform:"rotate(90, 0, ".concat(Z/2,")"),children:[n.slice(2),"2"]})}),(0,r.jsx)("g",{ref:C,transform:"translate(".concat(L,", ").concat(N,")")}),(0,r.jsx)("g",{transform:"translate(".concat(P,", ").concat(I,")"),children:(0,r.jsx)(_.r,{color:F,title:"CNV Value",height:320,width:40,legendMarginTop:0,ticks:z[2]-z[0]+1})})]})})}),(0,h.createPortal)((0,r.jsx)(g.Z,{ref:y}),document.body)]})}),R=(e,t,n,r,a)=>{a.current.showTooltip(e,(0,d.C)(t,n,r))},k=e=>{e.current.hideTooltip()};A.displayName="GeneEmbeddingMapPanel";let Z=(0,a.forwardRef)((e,t)=>{let{embeddingMethod:n,extents:l,meta:o,term:d,terms:f,config:p,isLog:m}=e,x=(0,a.useRef)(null),y=(0,a.useRef)(null),j=(0,a.useRef)(null),v=(0,a.useRef)(null),C=(0,a.useRef)(null),{svgWidth:b,svgHeight:w,innerWidth:A,figureSize:R,subTitleMarginTop:k,xOffsetScatterPlot:Z,yOffsetScatterPlot:N,yOffsetXAxis:T,xOffsetLegend:P,yOffsetLegend:I,xRange:H,yRange:E,CNARange:z,CNAValueScale:F}=(0,c.lY)(920,p,m),W=(0,c.$R)(n,l),{x:Y,y:B}=(0,c.yX)(W,H,E);return(0,a.useEffect)(()=>{i.Ys(j.current).call(i.LLu(Y))},[Y]),(0,a.useEffect)(()=>{i.Ys(v.current).call(i.y4O(B))},[B]),(0,a.useEffect)(()=>{i.Ys(C.current).selectAll("circle").data(o,e=>e.id).join("circle").attr("cx",e=>Y(e["".concat(n,"1")])).attr("cy",e=>B(e["".concat(n,"2")])).attr("r",p.scatter.radius).attr("fill",e=>F(f[e.id])).on("pointerenter pointermove",(e,t)=>M(e,t.id,[t["".concat(n,"1")],t["".concat(n,"2")]],f[t.id],y)).on("pointerleave",()=>L(y))},[F,p.scatter.radius,n,f,o,Y,B]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{x.current&&(0,u.X)(x.current,"".concat(n.slice(2),"_Embedding_Map.svg"))}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{sx:{alignItems:"center",overflowX:"auto"},children:(0,r.jsx)("svg",{ref:x,width:b,height:w,children:(0,r.jsxs)("g",{className:"plotContainer",transform:"translate(".concat(p.chart.margin,", ").concat(p.chart.margin,")"),children:[(0,r.jsxs)("g",{className:"title",children:[(0,r.jsxs)("text",{fontSize:p.title.fontSize,transform:"translate(".concat(b/2,", ").concat(p.title.marginTop,")"),dy:"1em",textAnchor:"middle",fontWeight:500,children:[n.slice(2)," Embedding Map"]}),(0,r.jsxs)("text",{fontSize:p.title.subFontSize,transform:"translate(".concat(b/2,", ").concat(k,")"),dy:"1em",textAnchor:"middle",fontWeight:500,fill:"#B0B0B0",children:[(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Color By: "}),(0,r.jsxs)("tspan",{children:["Term (",d.value,")\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"]}),(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Variance: "}),(0,r.jsx)("tspan",{children:S().round(d.variance,3)})]})]}),(0,r.jsx)("g",{ref:j,transform:"translate(".concat(Z,", ").concat(T,")"),children:(0,r.jsxs)("text",{x:R/2,y:36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",children:[n.slice(2),"1"]})}),(0,r.jsx)("g",{ref:v,transform:"translate(".concat(Z,", ").concat(N,")"),children:(0,r.jsxs)("text",{y:R/2+36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",transform:"rotate(90, 0, ".concat(R/2,")"),children:[n.slice(2),"2"]})}),(0,r.jsx)("g",{ref:C,transform:"translate(".concat(Z,", ").concat(N,")")}),(0,r.jsx)("g",{transform:"translate(".concat(P,", ").concat(I,")"),children:(0,r.jsx)(_.r,{color:F,title:"CNV Value",height:320,width:40,legendMarginTop:0,ticks:z[2]-z[0]+1})})]})})}),(0,h.createPortal)((0,r.jsx)(g.Z,{ref:y}),document.body)]})}),M=(e,t,n,r,a)=>{a.current.showTooltip(e,(0,d.C)(t,n,r))},L=e=>{e.current.hideTooltip()};Z.displayName="TermEmbeddingMapPanel";let N=(0,a.forwardRef)((e,t)=>{let{embeddingMethod:n,extents:l,meta:o,bin:d,bins:f,config:p,isLog:m}=e,x=(0,a.useRef)(null),y=(0,a.useRef)(null),j=(0,a.useRef)(null),v=(0,a.useRef)(null),C=(0,a.useRef)(null),{svgWidth:b,svgHeight:w,innerWidth:A,figureSize:R,subTitleMarginTop:k,xOffsetScatterPlot:Z,yOffsetScatterPlot:M,yOffsetXAxis:L,xOffsetLegend:N,yOffsetLegend:I,xRange:H,yRange:E,CNARange:z,CNAValueScale:F}=(0,c.lY)(920,p,m),W=(0,c.$R)(n,l),{x:Y,y:B}=(0,c.yX)(W,H,E);return(0,a.useEffect)(()=>{i.Ys(j.current).call(i.LLu(Y))},[Y]),(0,a.useEffect)(()=>{i.Ys(v.current).call(i.y4O(B))},[B]),(0,a.useEffect)(()=>{i.Ys(C.current).selectAll("circle").data(o,e=>e.id).join("circle").attr("cx",e=>Y(e["".concat(n,"1")])).attr("cy",e=>B(e["".concat(n,"2")])).attr("r",p.scatter.radius).attr("fill",e=>F(f[e.id])).on("pointerenter pointermove",(e,t)=>T(e,t.id,[t["".concat(n,"1")],t["".concat(n,"2")]],f[t.id],y)).on("pointerleave",()=>P(y))},[F,f,p.scatter.radius,n,o,Y,B]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{x.current&&(0,u.X)(x.current,"".concat(n.slice(2),"_Embedding_Map.svg"))}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{sx:{alignItems:"center",overflowX:"auto"},children:(0,r.jsx)("svg",{ref:x,width:b,height:w,children:(0,r.jsxs)("g",{className:"plotContainer",transform:"translate(".concat(p.chart.margin,", ").concat(p.chart.margin,")"),children:[(0,r.jsxs)("g",{className:"title",children:[(0,r.jsxs)("text",{fontSize:p.title.fontSize,transform:"translate(".concat(b/2,", ").concat(p.title.marginTop,")"),dy:"1em",textAnchor:"middle",fontWeight:500,children:[n.slice(2)," Embedding Map"]}),(0,r.jsxs)("text",{fontSize:p.title.subFontSize,transform:"translate(".concat(b/2,", ").concat(k,")"),dy:"1em",textAnchor:"middle",fontWeight:500,fill:"#B0B0B0",children:[(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Color By: "}),(0,r.jsxs)("tspan",{children:["Bin (",d.value,")\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"]}),(0,r.jsx)("tspan",{fontWeight:"bold",fill:"#000000",opacity:.6,children:"Variance: "}),(0,r.jsx)("tspan",{children:S().round(d.variance,3)})]})]}),(0,r.jsx)("g",{ref:j,transform:"translate(".concat(Z,", ").concat(L,")"),children:(0,r.jsxs)("text",{x:R/2,y:36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",children:[n.slice(2),"1"]})}),(0,r.jsx)("g",{ref:v,transform:"translate(".concat(Z,", ").concat(M,")"),children:(0,r.jsxs)("text",{y:R/2+36,fontSize:14,fontWeight:"bold",fill:"black",textAnchor:"middle",transform:"rotate(90, 0, ".concat(R/2,")"),children:[n.slice(2),"2"]})}),(0,r.jsx)("g",{ref:C,transform:"translate(".concat(Z,", ").concat(M,")")}),(0,r.jsx)("g",{transform:"translate(".concat(N,", ").concat(I,")"),children:(0,r.jsx)(_.r,{color:F,title:"CNV Value",height:320,width:40,legendMarginTop:0,ticks:z[2]-z[0]+1})})]})})}),(0,h.createPortal)((0,r.jsx)(g.Z,{ref:y}),document.body)]})}),T=(e,t,n,r,a)=>{a.current.showTooltip(e,(0,d.C)(t,n,r))},P=e=>{e.current.hideTooltip()};N.displayName="BinEmbeddingMapPanel";let I=e=>{let{embeddingMethod:t,renderData:n,extents:a,config:l,vizRef:o}=e;return(0,r.jsx)(r.Fragment,{children:Array.isArray(null==n?void 0:n.processedMeta)&&(null==n?void 0:n.processedMeta.length)===0?(0,r.jsx)(j.Z,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(j.Z,{sx:{fontWeight:500,fontSize:"28px"},children:"Number of samples is less than the number of clusters."})}):(0,r.jsx)(f,{embeddingMethod:t,cluster:null==n?void 0:n.cluster,meta:null==n?void 0:n.processedMeta,extents:a,config:l,ref:o})})},H=e=>{let{embeddingMethod:t,renderData:n,extents:a,config:l,processing:o,isShowLeft:i,handleIsShowLeftChange:c,isLog:s,vizRef:d}=e,h={cluster:(0,r.jsx)(I,{embeddingMethod:t,renderData:n,extents:a,config:l,isShowLeft:i,handleIsShowLeftChange:c,vizRef:d}),bin:(0,r.jsx)(N,{embeddingMethod:t,meta:null==n?void 0:n.processedMeta,bin:null==n?void 0:n.bin,bins:null==n?void 0:n.binVector,extents:a,config:l,isLog:s,ref:d}),gene:(0,r.jsx)(A,{embeddingMethod:t,meta:null==n?void 0:n.processedMeta,gene:null==n?void 0:n.gene,genes:null==n?void 0:n.geneVector,extents:a,config:l,isLog:s,ref:d}),term:(0,r.jsx)(Z,{embeddingMethod:t,meta:null==n?void 0:n.processedMeta,term:null==n?void 0:n.term,terms:null==n?void 0:n.termVector,extents:a,config:l,isLog:s,ref:d})};return(0,r.jsxs)(j.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(j.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(v.Z,{isShowLeft:i,handleIsShowLeftChange:c,title:"Setting Options"})}),o?(0,r.jsx)(b.Z,{containerSx:{height:"910px"},loadingPrompt:"Processing Data..., please wait for a moment."}):null===n?(0,r.jsx)(j.Z,{sx:{width:"100%",height:"100%",padding:"0px 60px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(j.Z,{sx:{fontWeight:500,fontSize:"28px",textAlign:"center"},children:"Use the Data Setting panel to configure the embedding method and coloring strategy. Click Render to generate the visualization based on your selections."})}):h[n.type]]})};var E=e=>{let{meta:t,embeddingMethods:n,extents:s,newick:d,bins:h,genes:g,terms:u,dataset:f,binVectorFetcher:p,geneVectorFetcher:m,termVectorFetcher:x,isLog:y,vizRef:j}=e,[v,b]=(0,a.useState)(n[0].value),[_,w]=(0,a.useState)({colorBy:"cluster",cluster:5,gene:g[0],term:u[0],bin:h[0]}),[S,A]=(0,a.useState)(null),[R,k]=(0,a.useState)(!0),[Z,M]=(0,a.useState)(!1),[L,N]=(0,a.useState)(!1),[T,P]=(0,a.useState)({chart:{margin:30,axisWidth:50},scatter:{radius:4},title:{marginTop:20,marginBottom:20,fontSize:24,subFontSize:16},legend:{width:120,height:25,itemVerticalGap:5,itemHorizontalGap:5,marginLeft:30}}),I=(0,a.useMemo)(()=>(0,c.fP)(t,d,_.cluster),[_.cluster,t,d]),E=async()=>{N(!0);try{if("cluster"===_.colorBy)A({type:"cluster",cluster:_.cluster,processedMeta:I}),await new Promise(requestAnimationFrame);else if("bin"===_.colorBy){let e=await p(_.bin.value),t=i.ueB(e.data,i.rA8).reduce((e,t)=>{let{id:n,...r}=t;return e[n]=Object.values(r)[0],e},{});A({type:"bin",bin:_.bin,processedMeta:I,binVector:t})}else if("gene"===_.colorBy){let e=await m(_.gene.value),t=i.ueB(e.data,i.rA8).reduce((e,t)=>{let{id:n,...r}=t;return e[n]=Object.values(r)[0],e},{});A({type:"gene",gene:_.gene,processedMeta:I,geneVector:t})}else if("term"===_.colorBy){let e=await x(_.term.value),t=i.ueB(e.data,i.rA8).reduce((e,t)=>{let{id:n,...r}=t;return e[n]=Object.values(r)[0],e},{});A({type:"term",term:_.term,processedMeta:I,termVector:t})}else A(null)}catch(e){console.error(e)}finally{N(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{isShowLeft:R,leftPanelWidth:300,leftPanel:(0,r.jsx)(o.ZP,{bins:h,genes:g,terms:u,embeddingMethod:v,handleEmbeddingMethodChange:e=>{b(e)},colorOptions:_,handleColorOptionsChange:(e,t)=>{w(n=>({...n,[e]:t}))},config:T,handleConfigChange:(e,t,n)=>{P(r=>({...r,[e]:{...r[e],[t]:n}}))},onRender:E,resetRenderData:()=>{A(null)},metaFieldOptions:n,showModal:()=>{M(!0)}}),rightPanel:(0,r.jsx)(H,{embeddingMethod:v,renderData:S,extents:s,config:T,processing:L,isShowLeft:R,handleIsShowLeftChange:()=>{k(!R)},isLog:y,vizRef:j})}),(0,r.jsx)(C.Z,{dataset:f,cluster:_.cluster,meta:I,isModalOpen:Z,handleModalCancel:()=>{M(!1)}})]})}},96570:function(e,t,n){var r=n(85893);t.Z=e=>{let{buttonWidth:t,buttonHeight:n,currentNodeIndex:a,nodeHistoryList:l,goBackRoot:o,goForwardNode:i,goBackNode:c}=e;return(0,r.jsxs)("g",{children:[(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",{width:2*t+4,height:n,fill:0===a?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:0===a?"not-allowed":"pointer",onClick:0===a?null:o}),(0,r.jsx)("text",{fontSize:10,x:t+2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Back To Root"})]}),(0,r.jsxs)("g",{transform:"translate(0, ".concat(n+4,")"),children:[(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",{width:t,height:n,fill:0===a?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:0===a?"not-allowed":"pointer",onClick:0===a?null:c}),(0,r.jsx)("text",{fontSize:10,x:t/2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Prev"})]}),(0,r.jsxs)("g",{transform:"translate(".concat(t+4,", 0)"),children:[(0,r.jsx)("rect",{width:t,height:n,fill:a===l.length-1?"#AAE3D8":"#41B3A2",rx:5,ry:5,cursor:a===l.length-1?"not-allowed":"pointer",onClick:a===l.length-1?null:i}),(0,r.jsx)("text",{fontSize:10,x:t/2,y:n/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",pointerEvents:"none",children:"Next"})]})]})]})}},78547:function(e,t,n){var r=n(85893),a=n(11927),l=n(67294),o=n(77225),i=n(69984);let c=(e,t,n,r)=>{let l=a.Ys(e.current),o=[[[t.verticalPosition,t.horizontalPosition],[n+r,t.topX]],[[t.verticalPosition,t.horizontalPosition],[n+r,t.bottomX]]],i=a.jvg().x(e=>e[0]).y(e=>e[1]).curve(a.qpX);l.selectAll("path").data(o).join("path").attr("fill","none").attr("stroke","black").attr("d",e=>i(e))},s=e=>{a.Ys(e.current).selectAll("path").remove()};t.Z=e=>{let{root:t,nodes:n,leaves:d,goToTreeNode:h,settings:g,showTooltip:u,hideTooltip:f,isShowNodeCurve:p=!0}=e,m=(0,l.useRef)(null),x=(0,l.useRef)(null),y=(0,l.useRef)(null),j=(0,l.useRef)(null),v=t.links().filter(e=>n.includes(e.source)&&n.includes(e.target));return(0,l.useEffect)(()=>{a.Ys(x.current).selectAll("path").data(v).join("path").attr("d",i.SE)},[v]),(0,l.useEffect)(()=>{let e=a.Ys(y.current);s(j),e.selectAll("circle").data(n,e=>e.data.name).join("circle").attr("transform",i.Qo).attr("r",g.nodeRadius).attr("fill",e=>e.children?"#333":"#999").on("click",(e,t)=>{t.children&&h(t.data.name)}).on("mouseover",(e,t)=>{d.includes(t)&&p&&c(j,t,g.width,g.marginToHeatmap),u(e,(0,o.R6)(t.data.name,t.parent?t.parent.data.name:"NONE",t.value,t.data.distanceToRoot))}).on("mousemove",(e,t)=>{u(e,(0,o.R6)(t.data.name,t.parent?t.parent.data.name:"NONE",t.value,t.data.distanceToRoot))}).on("mouseout",f)},[n,h,g.nodeRadius,f,u,g.width,d,g.marginToHeatmap,p]),(0,r.jsxs)("g",{ref:m,children:[(0,r.jsx)("g",{ref:x,className:"links",fill:"none",stroke:"#000000"}),(0,r.jsx)("g",{ref:y,className:"nodes",cursor:"pointer",pointerEvents:"all"}),(0,r.jsx)("g",{ref:j,className:"curves"})]})}},76415:function(e,t,n){n.d(t,{Z:function(){return eu}});var r=n(85893),a=n(67294),l=n(33750),o=n(89073),i=n(13368),c=n(22904),s=n(34953),d=n(93870),h=n(26163),g=n(76709),u=n(43594),f=n(30441),p=n(58514),m=n(45114);let x=e=>{let{title:t,value:n,color:a}=e;return(0,r.jsx)(f.Z,{title:t,placement:"top",children:(0,r.jsx)(m.Z,{value:n,color:a})})},y=e=>{let{entity:t,selectedGenes:n,sortedGenes:a,showModal:l}=e;return(0,r.jsxs)(o.Z,{spacing:1,children:[(0,r.jsxs)(i.Z,{sx:{fontWeight:500},children:["Selected ","".concat(t,"s"),":"]}),(0,r.jsxs)(o.Z,{direction:"row",sx:{flexWrap:"wrap",width:"100%",rowGap:"6px"},children:[0===n.length?(0,r.jsx)(m.Z,{value:"No Selected ".concat(t,"s"),color:"red"}):a.slice(0,9).map((e,t)=>(0,r.jsx)(m.Z,{value:e.gene,color:"volcano"},t)),n.length>9?(0,r.jsx)(x,{title:"Click to see all selected ".concat(t,"s."),value:"+".concat(n.length-9," ").concat(t,"s"),color:"volcano"}):(0,r.jsx)(r.Fragment,{})]})]})},j=e=>{let{showModal:t,resetSelectedGenes:n,renderHeatMap:a}=e;return(0,r.jsxs)(o.Z,{spacing:1,sx:{mt:3,mb:2},children:[(0,r.jsxs)(o.Z,{direction:"row",sx:{justifyContent:"space-between"},children:[(0,r.jsx)(p.ZP,{style:{width:"110px",backgroundColor:"#41B3A2",color:"#FFFFFF",borderColor:"#41B3A2"},onClick:t,children:"Select"}),(0,r.jsx)(p.ZP,{style:{width:"110px",color:"#41B3A2",borderColor:"#41B3A2"},onClick:n,children:"Reset"})]}),(0,r.jsx)(p.ZP,{style:{backgroundColor:"#41B3A2",color:"#FFFFFF",borderColor:"#41B3A2"},onClick:a,children:"Render"})]})};var v=e=>{let{entity:t,selectedGenes:n,sortedGenes:a,showModal:l,resetSelectedGenes:o,renderHeatMap:i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y,{entity:t,selectedGenes:n,sortedGenes:a,showModal:l}),(0,r.jsx)(j,{showModal:l,resetSelectedGenes:o,renderHeatMap:i})]})};let C=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(g._,{title:"Mode:",config:t,configKey:n,configSubKey:"mode",options:[{label:"Fixed",value:"Fixed"},{label:"Adaptive",value:"Adaptive"}],handleConfigChange:a}),(0,r.jsx)(u.e,{title:"CNA Rect Width:",config:t,configKey:n,configSubKey:"CNARectWidth",handleConfigChange:a}),(0,r.jsx)(u.e,{title:"Meta Rect Width:",config:t,configKey:n,configSubKey:"metaRectWidth",handleConfigChange:a}),"Fixed"===t.heatmap.mode?(0,r.jsx)(u.e,{title:"Rect Height:",config:t,configKey:n,configSubKey:"rectHeight",handleConfigChange:a}):(0,r.jsx)(u.e,{title:"Height:",config:t,configKey:n,configSubKey:"height",handleConfigChange:a})]})},b=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(u.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(u.e,{title:"Node Radius:",config:t,configKey:n,configSubKey:"nodeRadius",handleConfigChange:a}),(0,r.jsx)(u.e,{title:"Margin To Heatmap:",config:t,configKey:n,configSubKey:"marginToHeatmap",handleConfigChange:a})]})},_=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(u.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(u.e,{title:"Height:",config:t,configKey:n,configSubKey:"height",handleConfigChange:a})]})},w=(e,t,n,a,l,o,i,c)=>[{key:"data",label:"".concat(e," Setting"),extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(v,{entity:e,selectedGenes:a,sortedGenes:l,resetSelectedGenes:c,showModal:o,renderHeatMap:i})},{key:"heatmap",label:"Heatmap Setting",extra:(0,r.jsx)(h.Z,{}),children:(0,r.jsx)(C,{config:t,configKey:"heatmap",handleConfigChange:n})},{key:"tree",label:"Tree Setting",extra:(0,r.jsx)(h.Z,{}),children:(0,r.jsx)(b,{config:t,configKey:"tree",handleConfigChange:n})},{key:"nodeHistory",label:"Node History Setting",extra:(0,r.jsx)(h.Z,{}),children:(0,r.jsx)(_,{config:t,configKey:"nodeHistory",handleConfigChange:n})}];var S=e=>{let{entity:t,config:n,handleConfigChange:l,selectedGenes:o,sortedGenes:d,showModal:h,renderHeatMap:g,resetSelectedGenes:u}=e,[f,p]=(0,a.useState)(["data","heatmap","tree"]),m=(0,a.useMemo)(()=>w(t,n,l,o,d,h,g,u),[t,n,l,o,d,h,g,u]);return(0,r.jsxs)(i.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(c.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(s.Z,{items:m,activeKey:f,onChange:e=>{p(e)},size:"middle"})}),(0,r.jsx)(i.Z,{sx:{paddingTop:"12px"}})]})},A=n(53224);let R=()=>(0,r.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",transform:"rotate(45)",children:(0,r.jsx)("path",{d:"M661.504 616.6016H381.44a35.328 35.328 0 1 1 0-70.656h314.5728c2.3552-11.3152 3.5328-23.04 3.5328-35.328 0-69.376-39.0656-123.136-117.6064-172.1344a35.328 35.328 0 0 1 37.4272-59.9552c97.1776 60.672 150.8352 134.4 150.8352 232.0384 0 115.2-65.8432 189.952-198.5536 259.072 24.2688 10.2912 47.3088 20.0192 56.4224 24.064 96.768 43.4176 142.1312 80.1792 142.1312 140.9536a35.328 35.328 0 1 1-70.656 0c0-20.992-28.928-44.3904-100.352-76.3904-16.128-7.168-81.408-34.5088-113.4592-48.2816-30.72 13.1072-87.1936 36.9664-102.912 44.032-75.9808 34.0992-107.3664 59.0336-107.3664 80.64a35.328 35.328 0 1 1-70.656 0c0-61.8496 47.2576-99.4816 149.1456-145.1008 20.1216-9.0624 100.864-43.008 119.296-51.2 90.624-40.0384 152.3712-78.08 188.2112-121.7536z m-382.5152-141.312c-2.3552 11.264-3.5328 23.04-3.5328 35.328 0 69.3248 39.0656 123.0336 117.6064 172.032a35.328 35.328 0 1 1-37.4272 60.0064C258.4576 681.984 204.8 608.2048 204.8 510.5664c0-114.6368 65.1776-189.184 196.7104-258.048a3839.0272 3839.0272 0 0 1-50.9952-22.0672C251.2896 185.5488 204.8 147.968 204.8 86.528a35.328 35.328 0 1 1 70.656 0c0 21.504 30.3104 46.08 104.1408 79.4624 16.4352 7.424 76.3392 32.768 107.4176 46.1312 30.0544-12.9024 89.088-37.7856 105.1136-45.056C668.16 133.12 699.5456 108.1344 699.5456 86.528a35.328 35.328 0 1 1 70.656 0c0 61.8496-47.3088 99.4304-149.1456 145.1008-18.7392 8.448-90.0608 38.5024-114.688 49.152a35.5328 35.5328 0 0 1-9.5744 4.2496c-88.0128 39.2704-148.1216 76.6976-183.296 119.552h280.0128a35.328 35.328 0 0 1 0 70.656H278.9888z"})});var k=e=>(0,r.jsx)(A.Z,{component:R,...e}),Z=n(85417),M=n(31816),L=n(69980),N=n(38304),T=n(2516),P=n(73484),I=n(77874);let H=()=>(0,r.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",children:(0,r.jsx)("path",{d:"M878.08 731.274667a32 32 0 0 1-54.88-32.938667A360.789333 360.789333 0 0 0 874.666667 512c0-200.298667-162.368-362.666667-362.666667-362.666667S149.333333 311.701333 149.333333 512s162.368 362.666667 362.666667 362.666667a360.789333 360.789333 0 0 0 186.314667-51.445334 32 32 0 0 1 32.928 54.88A424.778667 424.778667 0 0 1 512 938.666667C276.362667 938.666667 85.333333 747.637333 85.333333 512S276.362667 85.333333 512 85.333333s426.666667 191.029333 426.666667 426.666667c0 78.293333-21.152 153.568-60.586667 219.274667zM650.666667 437.333333c0 65.898667-46.72 120.853333-109.194667 135.082667V608a32 32 0 0 1-64 0v-64a32 32 0 0 1 32-32C552.266667 512 586.666667 478.4 586.666667 437.333333s-34.4-74.666667-77.194667-74.666666c-26.773333 0-51.082667 13.248-65.173333 34.624a73.088 73.088 0 0 0-8.522667 17.717333 32 32 0 0 1-60.885333-19.690667c3.797333-11.754667 9.173333-22.933333 15.978666-33.237333 25.856-39.253333 70.186667-63.413333 118.613334-63.413333C587.274667 298.666667 650.666667 360.576 650.666667 437.333333zM512 736a32 32 0 1 1 0-64 32 32 0 0 1 0 64z"})});var E=e=>(0,r.jsx)(A.Z,{component:H,...e});let z=e=>{let{handleDelete:t,handleDeleteCancel:n}=e;return(0,r.jsxs)(T.Z,{vertical:!0,gap:4,children:[(0,r.jsx)(T.Z,{justify:"center",children:(0,r.jsx)(E,{style:{fontSize:"24px",color:"#faad14"}})}),(0,r.jsx)(T.Z,{justify:"center",children:(0,r.jsx)(i.Z,{sx:{fontSize:"14px"},children:"Sure to Delete?"})}),(0,r.jsx)(i.Z,{component:"hr",sx:{margin:"0px 0px 4px 0px"}}),(0,r.jsxs)(T.Z,{gap:8,justify:"center",children:[(0,r.jsx)(p.ZP,{danger:!0,size:"small",onClick:t,children:"Confirm"}),(0,r.jsx)(p.ZP,{size:"small",color:"primary",variant:"outlined",onClick:n,children:"Cancel"})]})]})};var F=e=>{let{handleDelete:t}=e,[n,l]=(0,a.useState)(!1);return(0,r.jsx)(I.Z,{placement:"top",content:(0,r.jsx)(z,{handleDelete:t,handleDeleteCancel:()=>{l(!1)}}),trigger:["click"],open:n,onOpenChange:e=>{l(e)},styles:{body:{padding:"4px 8px 10px 8px"}},children:(0,r.jsx)(p.ZP,{danger:!0,type:"dashed",children:"Delete"})})},W=n(69386),Y=n(38236);let B=e=>{let{handleSearchTextChange:t}=e,[n,l]=(0,a.useState)("");return(0,r.jsx)(Y.Z.Search,{placeholder:"Search...",allowClear:!0,value:n,onChange:e=>l(e.target.value),onSearch:()=>{null==t||t(n)},onClear:()=>{null==t||t("")},style:{width:200}})},O=(0,n(97834).Z)(N.Z)({"& .ant-table":{"& .ant-table-container":{minHeight:385,"& .ant-table-body, & .ant-table-content":{scrollbarWidth:"thin",scrollbarColor:"#eaeaea transparent",scrollbarGutter:"stable","& .ant-empty":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:233}},"& .ant-table-header > table":{width:"max-content",minWidth:"100%","& .ant-table-cell-fix-right-first":{minWidth:"125px"}}}},"& .ant-spin-nested-loading":{"& .ant-spin":{maxHeight:1e3}}}),K={threshold:.3,keys:["gene"]},U=e=>{let{entity:t,selectedGenes:n,setSelectedGenes:l}=e,[o,c]=(0,a.useState)(""),[s,d]=(0,a.useState)([]),h=(0,L.z)(),g=(0,a.useMemo)(()=>o?new W.Z(n,K).search(o).map(e=>e.item):n,[n,o]),u=e=>{l(n.filter(t=>t.id!==e.id))},f={selectedRowKeys:s,columnWidth:"56px",onChange:e=>{d([...new Set([...e])])},selections:[N.Z.SELECTION_ALL,N.Z.SELECTION_INVERT,N.Z.SELECTION_NONE]},m=[{title:"".concat(t," Name"),dataIndex:"gene",key:"gene_name",align:"center",sorter:(e,t)=>e.gene.localeCompare(t.gene)},{title:"Action",key:"action",align:"center",render:(e,t)=>(0,r.jsx)(F,{handleDelete:()=>u(t)})}];return(0,r.jsxs)(i.Z,{sx:{width:"96%",margin:"auto",minHeight:"500px"},children:[(0,r.jsxs)(T.Z,{justify:"space-between",style:{margin:"8px 0px 16px 0px"},children:[(0,r.jsx)(p.ZP,{icon:(0,r.jsx)(P.Z,{count:s.length,showZero:!0}),onClick:()=>{0!==s.length&&(l(n.filter(e=>!s.includes(e.id))),h.open({type:"success",content:"Successfully Delete ".concat(s.length," Selected ").concat(t,"s!")}),d([]))},iconPosition:"end",children:"Delete Selected"}),(0,r.jsx)(B,{handleSearchTextChange:e=>{c(e)}})]}),(0,r.jsx)(O,{columns:m,dataSource:g,rowKey:"id",rowSelection:f,pagination:{defaultPageSize:5,showQuickJumper:!0,pageSizeOptions:[5,10,30,50,100],showSizeChanger:!0,showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," ").concat(t,"s")},scroll:{y:330}})]})},V=e=>{let{entity:t,genes:n,selectedGenes:l,setSelectedGenes:o}=e,[c,s]=(0,a.useState)(""),[d,h]=(0,a.useState)({rowKeys:[],rows:[]}),g=(0,L.z)(),u=(0,a.useMemo)(()=>c?new W.Z(n,K).search(c).map(e=>e.item):n,[n,c]),f=[{title:"".concat(t," Name"),dataIndex:"gene",key:"gene_name",align:"center",sorter:(e,t)=>e.gene.localeCompare(t.gene)},{title:"Action",key:"action",align:"center",render:(e,t)=>l.find(e=>e.id===t.id)?(0,r.jsx)(F,{handleDelete:()=>x(t)}):(0,r.jsx)(p.ZP,{type:"dashed",onClick:()=>y(t),children:"Add"})}],m={selectedRowKeys:d.rowKeys,columnWidth:"56px",onChange:(e,t)=>{h({rowKeys:e,rows:t})},preserveSelectedRowKeys:!0,selections:[N.Z.SELECTION_ALL,N.Z.SELECTION_INVERT,N.Z.SELECTION_NONE],getCheckboxProps:e=>({disabled:!!l.find(t=>t.id===e.id)})},x=e=>{o(l.filter(t=>t.id!==e.id)),h({rowKeys:l.filter(t=>t.id!==e.id).map(e=>e.id),rows:l.filter(t=>t.id!==e.id)})},y=e=>{o([...l,e]),h({rowKeys:[...d.rowKeys,e.id],rows:[...d.rows,e]})};return(0,r.jsxs)(i.Z,{sx:{width:"96%",margin:"auto",minHeight:"500px"},children:[(0,r.jsxs)(T.Z,{justify:"space-between",style:{margin:"8px 0px 16px 0px"},children:[(0,r.jsx)(p.ZP,{icon:(0,r.jsx)(P.Z,{count:d.rowKeys.length-l.length,showZero:!0}),iconPosition:"end",onClick:()=>{d.rowKeys.length>100?g.open({type:"warning",content:"Selecting more than 100 ".concat(t,"s is not allowed.")}):d.rowKeys.length-l.length!=0?(o([...d.rows]),g.open({type:"success",content:"Successfully Add ".concat(d.rowKeys.length-l.length," Selected ").concat(t,"s!")})):g.open({type:"warning",content:"At least one ".concat(t," must be selected before adding.")})},children:"Add Selected"}),(0,r.jsx)(B,{handleSearchTextChange:e=>{s(e)}})]}),(0,r.jsx)(O,{columns:f,rowSelection:m,rowKey:e=>e.id,dataSource:u,pagination:{defaultPageSize:5,showQuickJumper:!0,pageSizeOptions:[5,10,30,50,100],showSizeChanger:!0,showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," ").concat(t,"s")},scroll:{y:330}})]})};var G=e=>{let{entity:t,genes:n,isModalOpen:a,handleModalCancel:l,selectedGenes:o,setSelectedGenes:c}=e,s=(0,r.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(k,{style:{fontSize:"36px",marginRight:"6px"}}),(0,r.jsxs)(i.Z,{sx:{fontWeight:"500",fontSize:"28px",pointerEvents:"none"},children:["Selected ","".concat(t,"s")]}),(0,r.jsxs)(i.Z,{sx:{fontWeight:"normal",fontSize:"14px",color:"#888",position:"relative",top:"4px",pointerEvents:"none"},children:["(Maximum of 100 ","".concat(t,"s"),")"]})]});return(0,r.jsx)(Z.Z,{titleContent:s,open:a,onCancel:l,footer:[],width:1450,centered:!0,children:(0,r.jsx)(M.Z,{tabBarStyle:{marginLeft:"16px"},items:[{label:"Selected ".concat(t,"s"),key:"selected-genes",children:(0,r.jsx)(U,{entity:t,selectedGenes:o,setSelectedGenes:c})},{label:"Select ".concat(t,"s"),key:2,children:(0,r.jsx)(V,{entity:t,genes:n,selectedGenes:o,setSelectedGenes:c})}]})})},X=n(79967),D=n(19792),q=n(1657),$=n(69984),J=n(66710),Q=n(11927),ee=n(17028),et=e=>{let{legendWidth:t,legendHeight:n,colorScales:a,baselineCNA:l}=e,o=2===l?[0,2,10]:[-1,0,1],i=Q.PUr(o,["#add8e6","#ffffff","#6A0220"]);return(0,r.jsxs)("g",{children:[(0,r.jsx)(ee.n,{color:i,title:"CNV Value",width:t,legendMarginTop:0,ticks:o[2]-o[0]+1}),(0,r.jsx)(ee.n,{color:a.e_PCA1,title:"ePCA1",width:t,legendMarginTop:n}),(0,r.jsx)(ee.n,{color:a.e_PCA2,title:"ePCA2",width:t,legendMarginTop:2*n}),(0,r.jsx)(ee.n,{color:a.e_TSNE1,title:"e_TSNE1",width:t,legendMarginTop:3*n}),(0,r.jsx)(ee.n,{color:a.e_TSNE2,title:"e_TSNE2",width:t,legendMarginTop:4*n}),(0,r.jsx)(ee.n,{color:a.e_UMAP1,title:"e_UMAP1",width:t,legendMarginTop:5*n}),(0,r.jsx)(ee.n,{color:a.e_UMAP2,title:"e_UMAP2",width:t,legendMarginTop:6*n})]})},en=n(96570),er=n(78547),ea=n(73935),el=n(65420),eo=n(77225),ei=e=>{let{filteredMeta:t,xMeta:n,yMeta:l,metaFields:o,colorScales:i,showTooltip:c,hideTooltip:s}=e,d=(0,a.useRef)(null),h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=Q.Ys(d.current);e.call(Q.F5q(n).tickSize(0)).call(e=>e.select(".domain").remove()),e.selectAll(".tick text").attr("transform","rotate(-90)").attr("x",6).attr("y",.1*n.bandwidth()).style("text-anchor","start")},[n]),(0,a.useEffect)(()=>{Q.Ys(h.current).selectAll("g").data(Object.entries(t)).join("g").attr("transform",e=>"translate(0, ".concat(l(e[0]),")")).selectAll("rect").data(e=>e[1].map((t,n)=>({value:t,key:e[0],index:n}))).join("rect").attr("x",(e,t)=>n(o[t])).attr("width",n.bandwidth()-.05).attr("height",l.bandwidth()-.05).attr("fill",(e,t)=>i[o[t]](e.value)).on("mouseenter",(e,t)=>{c(e,(0,eo.xE)(t.key,i[o[t.index]](t.value),o[t.index],t.value))}).on("mousemove",(e,t)=>{c(e,(0,eo.xE)(t.key,i[o[t.index]](t.value),o[t.index],t.value))}).on("mouseout",s)},[i,t,s,o,c,n,l]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("g",{ref:d}),(0,r.jsx)("g",{ref:h})]})},ec=e=>{let{cutTreeCNVMatrix:t,xMatrix:n,yMatrix:l,geneInfos:o,CNVMatrixScale:i,showTooltip:c,hideTooltip:s}=e,d=(0,a.useRef)(null),h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=Q.Ys(d.current);e.call(Q.F5q(n).tickSize(0).tickFormat((e,t)=>o[t].gene)).call(e=>e.select(".domain").remove()),e.selectAll(".tick text").attr("transform","rotate(-90)").attr("x",6).attr("y",.1*n.bandwidth()).style("cursor","default").style("text-anchor","start")},[o,s,c,n]),(0,a.useEffect)(()=>{Q.Ys(h.current).selectAll("g").data(Object.entries(t)).join("g").attr("transform",e=>"translate(0, ".concat(l[e[0]].y,")")).selectAll("rect").data(e=>e[1].map((t,n)=>({value:t,key:e[0],index:n}))).join("rect").attr("x",(e,t)=>n(o[t].gene)).attr("width",n.bandwidth()-.05).attr("height",e=>l[e.key].height).attr("fill",e=>i(e.value)).on("mouseenter",(e,t)=>{c(e,(0,eo.xE)(t.key,i(t.value),o[t.index].gene,t.value))}).on("mousemove",(e,t)=>{c(e,(0,eo.xE)(t.key,i(t.value),o[t.index].gene,t.value))}).on("mouseout",s)},[i,t,o,s,c,n,l]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("g",{ref:d}),(0,r.jsx)("g",{ref:h})]})},es=n(9040);let ed=["e_PCA1","e_PCA2","e_TSNE1","e_TSNE2","e_UMAP1","e_UMAP2"],eh=(0,a.forwardRef)((e,t)=>{let{meta:n,newick:l,renderGenes:o,geneMatrix:c,baselineCNA:s,entity:d="Gene",cluster:h=64,config:g,isShowLeft:u,handleIsShowLeftChange:f}=e,{nodeHistoryList:p,currentNodeIndex:m,goBackNode:x,goForwardNode:y,goBackRoot:j,goToTreeNode:v}=(0,q.Z)(),C=(0,a.useRef)(null),b=(0,a.useRef)(null),_=(0,a.useRef)(null),w=(0,a.useMemo)(()=>(0,$.eC)(l),[l]),{processedMeta:S,colorScales:A}=(0,a.useMemo)(()=>(0,J.Z)(n,["e_PCA1","e_PCA2","e_TSNE1","e_TSNE2","e_UMAP1","e_UMAP2"],ed),[n]),{processedMatrix:R,CNVColorScale:k}=(0,a.useMemo)(()=>(0,J.y)(c,o,s),[s,c,o]),Z=w.find(e=>e.data.name===p[m]),{nodes:M,leaves:L,yMeta:N,xMeta:T,filteredMeta:P,xMatrix:I,yMatrix:H,cutTreeCNVMatrix:E}=(0,$.FB)(Z,h,S,ed,o,R,g.tree,g.heatmap),z=(e,t)=>{_.current.showTooltip(e,t)},F=()=>{_.current.hideTooltip()};return(0,a.useEffect)(()=>{let e=Q.sPX().scaleExtent([.1,10]).on("zoom",function(e){Q.Ys(b.current).attr("transform",e.transform)});Q.Ys(C.current).call(e)},[]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{C.current&&(0,es.X)(C.current,"".concat(d,"-Level_CNA_Heatmap.svg"))}})),(0,r.jsxs)(i.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(i.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(D.Z,{isShowLeft:u,handleIsShowLeftChange:f,title:"Setting Options"})}),(0,r.jsx)("svg",{ref:C,width:"100%",height:"100%",children:(0,r.jsxs)("g",{ref:b,transform:"translate(100, 100)",children:[(0,r.jsx)("g",{className:"ColorLegends",children:(0,r.jsx)(et,{legendWidth:g.legend.width,legendHeight:g.legend.height,colorScales:A,baselineCNA:s})}),(0,r.jsxs)("g",{className:"TreeChartContainer",transform:"translate(".concat(g.legend.width+50,")"),children:[(0,r.jsx)("g",{className:"NodeHistory",transform:"translate(200, -50)",children:(0,r.jsx)(en.Z,{buttonWidth:g.nodeHistory.width,buttonHeight:g.nodeHistory.height,currentNodeIndex:m,nodeHistoryList:p,goBackRoot:j,goForwardNode:y,goBackNode:x})}),(0,r.jsx)("g",{className:"TreeChart",children:(0,r.jsx)(er.Z,{root:Z,nodes:M,leaves:L,goToTreeNode:v,settings:g.tree,showTooltip:z,hideTooltip:F})})]}),(0,r.jsxs)("g",{transform:"translate(".concat(g.legend.width+50+g.tree.width+g.tree.marginToHeatmap,", 0)"),children:[(0,r.jsx)(ei,{filteredMeta:P,xMeta:T,yMeta:N,metaFields:ed,colorScales:A,showTooltip:z,hideTooltip:F}),(0,r.jsx)(ec,{cutTreeCNVMatrix:E,xMatrix:I,yMatrix:H,geneInfos:o,CNVMatrixScale:k,showTooltip:z,hideTooltip:F})]})]})}),(0,ea.createPortal)((0,r.jsx)(el.Z,{ref:_}),document.body)]})});eh.displayName="CNAGeneHeatmapPanel";let eg=e=>{let{entity:t,meta:n,newick:a,renderGenes:l,geneMatrix:o,baselineCNA:c,config:s,processing:d,isShowLeft:h,handleIsShowLeftChange:g,vizRef:u}=e;return(0,r.jsx)(r.Fragment,{children:d?(0,r.jsx)(X.Z,{containerSx:{height:"910px"},loadingPrompt:"Processing Data..., please wait for a moment."}):null===o?(0,r.jsx)(i.Z,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsxs)(i.Z,{sx:{fontWeight:500,fontSize:"28px"},children:["Please select ","".concat(t,"s")," to render the corresponding visualization."]})}):(0,r.jsx)(eh,{meta:n,newick:a,renderGenes:l,geneMatrix:o,baselineCNA:c,entity:t,config:s,isShowLeft:h,handleIsShowLeftChange:g,ref:u})})};var eu=e=>{let{meta:t,newick:n,genes:o,geneMatrixFetcher:i,baselineCNA:c,entity:s="Gene",vizRef:d}=e,[h,g]=(0,a.useState)(!0),[u,f]=(0,a.useState)(!1),[p,m]=(0,a.useState)([]),[x,y]=(0,a.useState)([]),[j,v]=(0,a.useState)(null),[C,b]=(0,a.useState)(!1),[_,w]=(0,a.useState)({heatmap:{mode:"Fixed",CNARectWidth:16,metaRectWidth:16,rectHeight:10,height:1e3},tree:{width:300,nodeRadius:4,marginToHeatmap:20},nodeHistory:{width:35,height:20},legend:{width:250,height:50,marginToTree:50}}),A=(0,a.useMemo)(()=>[...p].sort((e,t)=>e.gene.length-t.gene.length),[p]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{isShowLeft:h,leftPanelWidth:300,leftPanel:(0,r.jsx)(S,{entity:s,config:_,handleConfigChange:(e,t,n)=>{w(r=>({...r,[e]:{...r[e],[t]:n}}))},selectedGenes:p,sortedGenes:A,showModal:()=>{f(!0)},renderHeatMap:()=>{0!==p.length&&(b(!0),i(p.map(e=>e.gene)).then(e=>{""!==e.data?(v(e.data),y([...p])):v([])}).finally(()=>{b(!1)}))},resetSelectedGenes:()=>{m([])}}),rightPanel:(0,r.jsx)(eg,{entity:s,meta:t,newick:n,renderGenes:x,geneMatrix:j,baselineCNA:c,config:_,processing:C,isShowLeft:h,handleIsShowLeftChange:()=>{g(!h)},vizRef:d})}),(0,r.jsx)(G,{entity:s,genes:o,isModalOpen:u,handleModalCancel:()=>{f(!1)},selectedGenes:p,setSelectedGenes:m})]})}},78292:function(e,t,n){n.d(t,{Z:function(){return K}});var r=n(85893),a=n(11927),l=n(67294),o=n(33750),i=n(93870),c=n(26163),s=n(89073),d=n(13368),h=n(43594),g=n(2492),u=n(58514),f=n(22904),p=n(34953);let m=Array.from({length:9}).map((e,t)=>({value:t+2,label:t+2})),x=e=>{let{cluster:t,handleClusterChange:n,showModal:a}=e;return(0,r.jsxs)(s.Z,{spacing:3,children:[(0,r.jsxs)(s.Z,{spacing:1,children:[(0,r.jsx)(d.Z,{sx:{fontWeight:500},children:"Cluster:"}),(0,r.jsx)(g.default,{value:t,onChange:n,options:m,style:{width:"240px"},size:"large"})]}),(0,r.jsx)(u.ZP,{style:{backgroundColor:"#41B3A2",color:"#FFFFFF",borderColor:"#41B3A2"},onClick:a,children:"View Cluster Info"})]})},y=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(s.Z,{spacing:2,children:[(0,r.jsx)(h.e,{title:"Margin Top:",config:t,configKey:n,configSubKey:"marginTop",handleConfigChange:a}),(0,r.jsx)(h.e,{title:"Margin Bottom:",config:t,configKey:n,configSubKey:"marginBottom",handleConfigChange:a}),(0,r.jsx)(h.e,{title:"Margin Left:",config:t,configKey:n,configSubKey:"marginLeft",handleConfigChange:a}),(0,r.jsx)(h.e,{title:"Margin Right:",config:t,configKey:n,configSubKey:"marginRight",handleConfigChange:a})]})},j=(e,t,n,a,l)=>[{key:"data",label:"Data Setting",extra:(0,r.jsx)(i.Z,{}),children:(0,r.jsx)(x,{cluster:n,handleClusterChange:a,showModal:l})},{key:"chart",label:"Chart Setting",extra:(0,r.jsx)(c.Z,{}),children:(0,r.jsx)(y,{config:e,configKey:"chart",handleConfigChange:t})}];var v=e=>{let{cluster:t,handleClusterChange:n,config:a,handleConfigChange:o,showModal:i}=e,[c,s]=(0,l.useState)(["data","chart"]),h=(0,l.useMemo)(()=>j(a,o,t,n,i),[t,a,n,o,i]);return(0,r.jsxs)(d.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(f.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(p.Z,{items:h,activeKey:c,onChange:e=>{s(e)},size:"middle"})}),(0,r.jsx)(d.Z,{sx:{paddingTop:"12px"}})]})},C=n(75757);let b=(e,t,n)=>{let r="hg19"===n?C.Gk:C.sV,{nodePairs:a,prevValue:l,prevEnd:o}=w(e,t);for(let n=0;n<t.length;n++){let o=e[t[n]],i=t[n].match(/chr([XY\d]+):(\d+)-(\d+)/),c="chr".concat(i[1]),s=parseInt(i[2])+r[c],d=parseInt(i[3])+r[c];l!==o&&(a.push([s,o]),l=o),n===t.length-1&&a.push([d,o])}return a},_=(e,t,n,r,l,o)=>{let i="hg19"===l?C.en:C.qF,c="hg19"===l?C.Bl:C.Kp,s=e-n.chart.marginLeft-n.chart.marginRight,d=t-n.chart.marginTop-n.chart.marginBottom,h=Math.floor(.8*s/(n.legend.itemHorizontalGap+n.legend.width)),g=o<h?o:h,u=(s-g*n.legend.width-(g-1)*n.legend.itemHorizontalGap)/2+n.chart.marginLeft,f=(Math.ceil(o/h)+1)*n.legend.height+45+n.chart.marginTop,p=[n.chart.marginLeft,n.chart.marginLeft+s],m=[n.chart.marginTop+f+(d-f),n.chart.marginTop+f],x=a.BYU().domain(i).range([p[0],p[1]]),y=0===r?[-3,3]:[0,10],j=a.BYU().domain([y[0],y[1]]).range([m[0],m[1]]);return{rowLegendNum:h,legendOffset:u,xRange:p,yRange:m,x,y:j,xAxis:(e,t)=>{let n=Object.keys(c);e.call(a.LLu(t).tickValues(n).tickFormat(e=>c[e])).call(e=>e.selectAll(".tick line").attr("y2",(e,t)=>t%2==0?"6":"15")).call(e=>e.selectAll(".tick text").attr("y",(e,t)=>t%2==0?"9":"18"))},line:(e,t)=>a.jvg().curve(a.jsv).x(e=>t(e[0])).y(e=>j(e[1]))(e)}},w=(e,t)=>{let n=t[0].match(/chr[\w]+:(\d+)-(\d+)/),r=e[t[0]],a=parseInt(n[2]);return{nodePairs:[[parseInt(n[1]),r]],prevValue:r,prevEnd:a}};var S=n(73296),A=n(73935),R=n(65420),k=n(96486),Z=n.n(k);let M=e=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:"".concat(e.chromosome,": ").concat(e.xPosition)}),e.values.map((t,n)=>(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{display:"inline-block",marginRight:4,borderRadius:10,width:10,height:10,backgroundColor:e.colorScale(n)}}),(0,r.jsxs)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:["Cluster ",t.group]}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:Z().round(t.value,3)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]},n))]}),(0,r.jsx)("div",{style:{clear:"both"}})]});var L=n(9040),N=n(93513);let T=a.PKp(a.Cn1),P=(0,l.forwardRef)((e,t)=>{let{clusterMeans:n,cluster:o,config:i,baselineCNA:c,reference:s,isShowLeft:d}=e,[h,g]=(0,l.useState)([]),{width:u,height:f}=(0,S.Oj)(),p=d?u-320:u-20,m=f-20,x=(0,l.useRef)(null),y=(0,l.useRef)(null),j=(0,l.useRef)(null),v=(0,l.useRef)(null),C=(0,l.useRef)(null),w=(0,l.useRef)(null),k=(0,l.useRef)(null),Z=(0,l.useRef)(null),M=(0,l.useMemo)(()=>Object.keys(n).reduce((e,t)=>(e[t]=b(n[t],function(e){function t(e){let t=e.match(/(chr[\w]+):(\d+)-(\d+)/);return t?{chromName:t[1],start:parseInt(t[2],10),end:parseInt(t[3],10)}:null}return e.sort((e,n)=>{let r=t(e),a=t(n),l=function(e,t){let n=e=>{let t=e.match(/chr(\d+|X|Y|M)/);if(t){let e=t[1];return"X"===e?23:"Y"===e?24:"M"===e?25:parseInt(e,10)}return -1};return n(e)-n(t)}(r.chromName,a.chromName);return 0!==l?l:r.start-a.start})}(Object.keys(n[t])),s),e),{}),[n,s]),{rowLegendNum:N,legendOffset:P,xRange:F,yRange:W,x:Y,y:B,xAxis:O,line:K}=_(p,m,i,c,s,o);return(0,l.useEffect)(()=>{g(Object.keys(M).map((e,t)=>({name:e,display:!0,index:t})))},[M]),(0,l.useEffect)(()=>{a.Ys(x.current).call(O,Y),Z.current=Y},[Y,O]),(0,l.useEffect)(()=>{let e=a.Ys(y.current);e.selectAll(".tick .assist-line").remove(),e.call(a.y4O(B)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("class","assist-line").attr("x2",F[1]-F[0]).attr("stroke-opacity",e=>e===c?1:.2).attr("stroke-dasharray",e=>e===c?"10, 10":null)),e.selectAll(".yAxis-label").data([1]).join("text").attr("x",0===c?-24:-18).attr("y",W[1]-20).attr("text-anchor","start").attr("fill","black").attr("font-weight","bold").attr("class","yAxis-label").text(0===c?"↑ CN log2 ratio":"↑ CN")},[c,F,B,W]),(0,l.useEffect)(()=>{a.Ys(j.current).selectAll("path").data(h.filter(e=>e.display)).join("path").attr("clip-path","url(#ploidy-stairstep-clip)").attr("stroke",e=>T(e.index)).attr("fill","transparent").attr("d",e=>K(M[e.name],Y))},[h,K,M,Y]),(0,l.useEffect)(()=>{a.Ys(v.current).selectAll("g").data(h).join("g").attr("transform",(e,t)=>E(t,N,i)).each(function(e){let t=a.Ys(this);t.selectAll("line").data([e]).join("line").attr("x1",0).attr("y1",i.legend.height/2).attr("x2",i.legend.width/4).attr("y2",i.legend.height/2).attr("stroke",T(e.index)).attr("stroke-width",2).attr("opacity",e.display?1:.3),t.selectAll("text").data([e]).join("text").attr("x",i.legend.width/4+5).attr("dy","1rem").text(e=>"Cluster ".concat(e.name)).attr("font-size","14px").attr("font-family","sans-serif").attr("opacity",e.display?1:.3),t.selectAll("rect").data([e]).join("rect").attr("x",0).attr("y",0).attr("width",i.legend.width).attr("height",i.legend.height).attr("fill","transparent").attr("cursor","pointer").on("click",(e,t)=>{z(t,g)})})},[i,h,N]),(0,l.useEffect)(()=>{let e=a.sPX().scaleExtent([1,32]).extent([[F[0],W[1]],[F[1],W[0]]]).translateExtent([[F[0],-1/0],[F[1],1/0]]).on("zoom",e=>{Z.current=e.transform.rescaleX(Y),a.Ys(j.current).selectAll("path").data(h.filter(e=>e.display)).attr("d",e=>K(M[e.name],Z.current)),a.Ys(x.current).call(O,Z.current)});a.Ys(C.current).call(e)},[h,K,M,Y,O,F,W]),(0,l.useImperativeHandle)(t,()=>({downloadSvg:()=>{C.current&&(0,L.X)(C.current,"Ploidy_Stairstep.svg")}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{width:p,height:m,ref:C,children:[(0,r.jsx)("clipPath",{id:"ploidy-stairstep-clip",children:(0,r.jsx)("rect",{x:F[0],y:W[1],width:F[1]-F[0],height:W[0]-W[1]})}),(0,r.jsx)("text",{fontSize:"24px",transform:"translate(".concat(p/2,", ").concat(i.chart.marginTop,")"),dy:"1rem",fontWeight:500,textAnchor:"middle",children:"CN Stairstep"}),(0,r.jsx)("g",{ref:v,transform:"translate(".concat(P,", ").concat(i.chart.marginTop+45,")")}),(0,r.jsx)("g",{ref:x,transform:"translate(0,".concat(W[0],")")}),(0,r.jsx)("g",{ref:y,transform:"translate(".concat(F[0],", 0)")}),(0,r.jsx)("g",{ref:j}),(0,r.jsx)("rect",{transform:"translate(".concat(F[0],", ").concat(W[1],")"),width:F[1]-F[0],height:W[0]-W[1],fill:"transparent",onPointerEnter:e=>I(e,h,M,Z,w,i.chart.marginLeft,k,W,s),onPointerMove:e=>I(e,h,M,Z,w,i.chart.marginLeft,k,W,s),onMouseLeave:()=>H(w,k)}),(0,r.jsx)("g",{ref:k})]}),(0,A.createPortal)((0,r.jsx)(R.Z,{ref:w}),document.body)]})}),I=(e,t,n,r,l,o,i,c,s)=>{let d="hg19"===s?C.Bl:C.Kp,h=a.YFb(e=>e[0]).right,g=a.YFb(e=>parseInt(e)).left,u=t.filter(e=>e.display).map(e=>e.name),f=parseInt(r.current.invert(a.cx$(e)[0]+o)),p={},m=Object.keys(d),x=g(m,f),y=d[m[x]],j=0===x?f:f-parseInt(m[x-1]);for(let e of(p.chromosome=y,p.xPosition=j,p.colorScale=T,p.values=[],u)){let t=n[e],r=h(t,f)-1;p.values.push({group:e,value:t[r][1]})}a.Ys(i.current).selectAll("line").data([1]).join("line").attr("x1",r.current(f)).attr("x2",r.current(f)).attr("y1",c[0]).attr("y2",c[1]).attr("stroke-dasharray","5, 5").attr("stroke","black").attr("stroke-opacity",.3).style("pointer-events","none"),l.current.showTooltip(e,M(p))},H=(e,t)=>{e.current.hideTooltip(),a.Ys(t.current).selectAll("line").remove()},E=(e,t,n)=>{let r=e%t*(n.legend.width+n.legend.itemHorizontalGap),a=Math.floor(e/t)*(n.legend.height+n.legend.itemVerticalGap);return"translate(".concat(r,", ").concat(a,")")},z=(e,t)=>{t((0,N.Uy)(t=>{let n=t.find(t=>t.name===e.name);n&&(n.display=!n.display)}))};P.displayName="CNAPloidyStairstepPanel";var F=n(21333),W=n(19792),Y=n(2755);let B=(e,t,n,r)=>{let l=a.ueB(e,a.rA8),o=a.ueB(t,a.rA8),i=(0,F.Bu)(n,r);if(!i)return{clusterMeans:[],parsedMetaWithClusters:[]};let c=new Map;i.forEach(e=>{let[t,n]=e;n.forEach(e=>{c.set(e,t)})});let s=o.map(e=>{let t=c.get(e.id)||null;return{...e,cluster:t}}),d={},h={};for(let e of l){let t=c.get(e.id)||null;if(t){for(let[n,r]of(d[t]||(d[t]={},h[t]=0),Object.entries(e)))"id"!==n&&(d[t][n]=(d[t][n]||0)+r);h[t]+=1}}let g={};for(let e of Object.keys(d)){let t=h[e];for(let[n,r]of(g[e]={},Object.entries(d[e])))g[e][n]=r/t}return{clusterMeans:g,parsedMetaWithClusters:s}},O=e=>{let{clusterMeans:t,cluster:n,config:a,baselineCNA:l,reference:o,isShowLeft:i,handleIsShowLeftChange:c,vizRef:s}=e;return(0,r.jsxs)(d.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(d.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(W.Z,{isShowLeft:i,handleIsShowLeftChange:c,title:"Setting Options"})}),Array.isArray(t)&&0===t.length?(0,r.jsx)(d.Z,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(d.Z,{sx:{fontWeight:500,fontSize:"28px"},children:"Number of samples is less than the number of clusters."})}):(0,r.jsx)(P,{clusterMeans:t,cluster:n,config:a,baselineCNA:l,reference:o,isShowLeft:i,ref:s},n)]})};var K=e=>{let{matrix:t,meta:n,newick:a,dataset:i,baselineCNA:c,reference:s,vizRef:d}=e,[h,g]=(0,l.useState)(5),[u,f]=(0,l.useState)(!0),[p,m]=(0,l.useState)(!1),[x,y]=(0,l.useState)({chart:{marginTop:20,marginBottom:30,marginLeft:30,marginRight:20},legend:{width:150,height:20,itemHorizontalGap:10,itemVerticalGap:5}}),{clusterMeans:j,parsedMetaWithClusters:C}=(0,l.useMemo)(()=>B(t,n,a,h),[h,t,n,a]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{isShowLeft:u,leftPanelWidth:300,leftPanel:(0,r.jsx)(v,{cluster:h,handleClusterChange:e=>{g(e)},config:x,handleConfigChange:(e,t,n)=>{y(r=>({...r,[e]:{...r[e],[t]:n}}))},showModal:()=>{m(!0)}}),rightPanel:(0,r.jsx)(O,{clusterMeans:j,cluster:h,config:x,baselineCNA:c,reference:s,isShowLeft:u,handleIsShowLeftChange:()=>{f(!u)},vizRef:d})}),(0,r.jsx)(Y.Z,{dataset:i,cluster:h,meta:C,isModalOpen:p,handleModalCancel:()=>{m(!1)}})]})}},97356:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(85893),a=n(11927),l=n(13368),o=n(19792),i=n(67294),c=n(96486),s=n.n(c),d=n(75757);let h=(e,t,n,r)=>{let a=g(e),l=f(a,n.filter(e=>"Amp"===e.type),r),o=y(m(r),l,"amp"),i=g(t),c=f(i,n.filter(e=>"Del"===e.type),r);return{significantAmpRegions:a,ampRegionMap:o,significantDelRegions:i,delRegionMap:y(m(r),c,"del")}},g=e=>{let t=[];for(let n of e){let e=u(n.boundaries);t.push({cytoband:n.cytoband,start:e.range[0],end:e.range[1],genes:n.genes,chromosome:e.chromosome})}return s().orderBy(t.sort((e,t)=>e.start-t.start),[e=>parseInt(e.chromosome.replace("chr",""),10),"start"],["asc","asc"])},u=e=>{let t=e.match(/chr([XY\d]+):(\d+)-(\d+)/);return{chromosome:"chr".concat(t[1]),range:[parseInt(t[2]),parseInt(t[3])]}},f=(e,t,n)=>{let r=Object.keys("hg19"===n?d.Gk:d.sV).filter(e=>!["chrX","chrY"].includes(e)).sort((0,d.oD)()),a=r.reduce((e,t)=>(e[t]=[],e),{});for(let e of t)a[e.chromosome].push(e);let l={};for(let t of r){let n=j(a[t],e.filter(e=>e.chromosome===t));l[t]={normalRegions:n.nonOverlappingRegions,significantRegions:n.overlappingRegions}}return l},p=(e,t)=>{let n=e[t],r=[],a=1,l=2e5;for(;l<n;)r.push({start:a,end:l}),l=(a=l+1)+2e5-1;return r.push({start:a,end:n}),r},m=e=>{let t="hg38"===e?d.Ht:d.OW,n={};for(let e in d.Ht)"chrX"!==e&&"chrY"!==e&&(n[e]=p(t,e));return n};function x(e,t){return!(e.end<t.start||e.start>t.end)}function y(e,t,n){let r={};for(let a in e){let l=e[a],o=t[a].significantRegions,i=t[a].normalRegions;r[a]={normalRegions:[],significantRegions:[]},l.forEach(e=>{let t=function(e,t,n){let r=t.filter(t=>x(e,t));if(r.length>0)return Math.max(...r.map(e=>e["G-score"]));let a=n.filter(t=>x(e,t));return a.length>0?Math.max(...a.map(e=>e["G-score"])):0}(e,o,i),l=o.some(t=>x(e,t)),c={type:n,chromosome:a,start:e.start,end:e.end,"G-score":t};l?r[a].significantRegions.push(c):r[a].normalRegions.push(c)})}return r}let j=(e,t)=>{let n=[],r=[];for(let a of e){let e=[a];for(let r of t){let t=[];for(let a of e)if(a.end<r.start||a.start>r.end)t.push(a);else{let e=Math.max(a.start,r.start),l=Math.min(a.end,r.end);n.push({...a,start:e,end:l}),a.start<e&&t.push({...a,end:e}),a.end>l&&t.push({...a,start:l})}e=t}r.push(...e)}return{overlappingRegions:n,nonOverlappingRegions:r}},v=(e,t,n)=>{if("all"!==n)return{normalNodes:C(e[n].normalRegions,n,t,!1),significantNodes:C(e[n].significantRegions,n,t,!1)};{let n=[],r=[];for(let a of Object.keys(e).sort((0,d.oD)()))n.push(...C(e[a].normalRegions,a,t,!0)),r.push(...C(e[a].significantRegions,a,t,!0));return{normalNodes:n,significantNodes:r}}},C=(e,t,n,r,a)=>{let l="hg19"===a?d.OW:d.Ht;if(0===e.length)return[{x:b(1,t,r,a),y:0},{x:b(l[t],t,r,a),y:0}];let o=[{x:b(1,t,r,a),y:0},{x:b(e[0].start,t,r,a),y:e[0][n]}],i=e[0][n],c=b(e[0].end,t,r,a);for(let l of e.slice(1)){let e=b(l.start,t,r,a),s=b(l.end,t,r,a),d=l[n];c+1===e?i!==d&&o.push({x:e,y:d}):(o.push({x:c,y:0}),o.push({x:e,y:d})),c=s,i=d}return c!==b(l[t],t,r,a)&&o.push({x:c,y:0}),o.push({x:b(l[t],t,r,a),y:0}),o},b=(e,t,n,r)=>{let a=r?d.Gk:d.sV;return n?e+a[t]:e},_=(e,t,n)=>Math.ceil(("all"===t?e:e.filter(e=>e.chromosome===t)).reduce((e,t)=>{let r=t[n];return r>e?r:e},-1/0)),w=(e,t,n)=>{let r=e-2*n.chart.marginX,a=t-2*n.chart.marginY,l=n.title.marginTop+n.title.marginBottom+Math.ceil(1.31*n.title.fontSize),o=a-l-(n.legend.marginTop+n.legend.marginBottom+n.legend.height)-2*n.label.height,i=l+n.label.height,c=(r-(2*n.legend.width+n.legend.itemGap))/2,s=a-n.legend.marginBottom-n.legend.height,d=(o-n.chromosomeAxis.height)/2,h=[d+n.chromosomeAxis.height,o],g=l+n.label.height+o;return{figureHeight:o,figureWidth:r,yOffsetFigure:i,xOffsetFigure:0,xOffsetLegend:c,yOffsetLegend:s,ampYAxisRange:[d,0],delYAxisRange:h,xAxisRange:[0,r],yOffsetAmpLabel:l,yOffsetDelLabel:g}},S=(e,t,n,r,l,o)=>{let i,c;let s="hg19"===o?d.A7:d.cB,h="hg19"===o?d.OW:d.Ht;i=a.BYU().domain([0,r]).range(e),c=a.BYU().domain([0,r]).range(t);let g="all"===l?s:[0,h[l]];return{ampYAxis:i,delYAxis:c,xAxis:a.BYU().domain(g).range(n),area:(e,t,n)=>a.SOn().curve(a.jsv).x(e=>t(e.x)).y0(n(0)).y1(e=>n(e.y))(e),labelLine:(e,t)=>a.jvg().curve(a.c_6).x(e=>t(e.x)).y(e=>e.y)(e),labelLineNodesCreator:(e,t,n,r,a)=>{let l=4.4*r;return a?[{x:t,y:n},{x:t,y:(n+l)/2},{x:e,y:l}]:[{x:t,y:0},{x:t,y:(n-l)/2},{x:e,y:n-l}]}}},A=(e,t)=>{let n="hg19"===t?d.x9:d.Sp,r="hg19"===t?d.OW:d.Ht;return"all"===e?n:{[e]:[1,r[e]]}},R=(e,t,n)=>{let r="hg19"===n?d.Gk:d.sV;return"all"===t?e.map(e=>({...e,start:e.start+r[e.chromosome],end:e.end+r[e.chromosome],anchorPosition:(e.start+e.end)/2+r[e.chromosome],labelPosition:(e.start+e.end)/2+r[e.chromosome]})):e.filter(e=>e.chromosome===t).map(e=>({...e,anchorPosition:(e.start+e.end)/2,labelPosition:(e.start+e.end)/2}))};var k=n(73296);let Z=e=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:"".concat(e.chromosome,": ").concat(e.xPosition)}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"Type"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:e.type}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:e.valueType}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:e.value}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})]}),(0,r.jsx)("div",{style:{clear:"both"}})]});var M=n(73935),L=n(65420),N=n(9040);let T=e=>e.filter(e=>{let t=e.Chromosome.trim();return"23"!==t&&"24"!==t}).map(e=>({type:e.Type,chromosome:"chr"+e.Chromosome.trim(),start:+e.Start,end:+e.End,"q-value":+e["-log10(q-value)"],"G-score":+e["G-score"],"average amplitude":+e["average amplitude"],frequency:+e.frequency})),P=(0,i.forwardRef)((e,t)=>{let{chromosome:n,focalInfo:c,config:s,reference:g,isShowLeft:u,handleIsShowLeftChange:f}=e,{width:p,height:m}=(0,k.Oj)(),x=u?p-320:p-20,y=m-20,j=(0,i.useRef)(null),C=(0,i.useRef)(null),b=(0,i.useRef)(null),Z=(0,i.useRef)(null),P=(0,i.useRef)(null),E=(0,i.useRef)(null),z=(0,i.useRef)(null),F=(0,i.useRef)(null),W=(0,i.useRef)(null),Y=(0,i.useRef)(null);(0,i.useRef)(null),(0,i.useRef)(null),(0,i.useRef)(null);let B=T(c.scores),{significantAmpRegions:O,ampRegionMap:K,significantDelRegions:U,delRegionMap:V}=(0,i.useMemo)(()=>h(c.amp,c.del,B,g),[c.amp,c.del,g,B]),G=(0,i.useMemo)(()=>v(K,"G-score",n),[K,n]),X=(0,i.useMemo)(()=>v(V,"G-score",n),[n,V]),D=(0,i.useMemo)(()=>_(B,n,"G-score"),[n,B]),{figureHeight:q,figureWidth:$,yOffsetFigure:J,xOffsetFigure:Q,xOffsetLegend:ee,yOffsetLegend:et,ampYAxisRange:en,delYAxisRange:er,xAxisRange:ea,yOffsetAmpLabel:el,yOffsetDelLabel:eo}=(0,i.useMemo)(()=>w(x,y,s),[s,y,x]),{ampYAxis:ei,delYAxis:ec,xAxis:es,area:ed,labelLine:eh,labelLineNodesCreator:eg}=(0,i.useMemo)(()=>S(en,er,ea,D,n,g),[en,n,er,g,ea,D]),eu=(0,i.useMemo)(()=>A(n,g),[n,g]);(0,i.useMemo)(()=>R(O,n,g),[n,g,O]),(0,i.useMemo)(()=>R(U,n,g),[n,g,U]);let ef=(0,i.useRef)(es);return ef.current=es,(0,i.useEffect)(()=>{a.Ys(Z.current).call(a.y4O(ei))},[ei]),(0,i.useEffect)(()=>{a.Ys(P.current).call(a.y4O(ec))},[ec]),(0,i.useEffect)(()=>{let e=a.Ys(E.current);e.selectAll("rect").data(Object.keys(eu).filter(e=>!["chrX","chrY"].includes(e)).sort((0,d.oD)())).join("rect").attr("x",e=>es(eu[e][0])).attr("width",e=>es(eu[e][1])-es(eu[e][0])).attr("height",s.chromosomeAxis.height).attr("fill",(e,t)=>t%2==0?"black":"white").attr("stroke","black"),e.selectAll("text").data(Object.keys(eu).filter(e=>!["chrX","chrY"].includes(e)).sort((0,d.oD)())).join("text").attr("x",e=>(es(eu[e][0])+es(eu[e][1]))/2).attr("y",s.chromosomeAxis.height/2).attr("dy",".31em").attr("fill",(e,t)=>t%2==0?"white":"black").attr("text-anchor","middle").attr("font-size","14px").text(e=>e.replace(/^chr/,""))},[eu,s.chromosomeAxis.height,es]),(0,i.useEffect)(()=>{a.Ys(z.current).selectAll("path").data(["amp"]).join("path").attr("fill","gray").attr("d",ed(G.normalNodes,es,ei)).attr("clip-path","url(#recurrent-regions-clip)")},[G.normalNodes,ei,ed,es]),(0,i.useEffect)(()=>{a.Ys(F.current).selectAll("path").data(["ampRecurrent"]).join("path").attr("fill","red").attr("d",ed(G.significantNodes,es,ei)).attr("clip-path","url(#recurrent-regions-clip)")},[G.significantNodes,ei,ed,es]),(0,i.useEffect)(()=>{a.Ys(W.current).selectAll("path").data(["del"]).join("path").attr("fill","gray").attr("d",ed(X.normalNodes,es,ec)).attr("clip-path","url(#recurrent-regions-clip)")},[ed,X.normalNodes,ec,es]),(0,i.useEffect)(()=>{a.Ys(Y.current).selectAll("path").data(["delRecurrent"]).join("path").attr("fill","blue").attr("d",ed(X.significantNodes,es,ec)).attr("clip-path","url(#recurrent-regions-clip)")},[ec,ed,es,X.significantNodes]),(0,i.useEffect)(()=>{let e=a.sPX().scaleExtent([1,32]).extent([[Q,J],[Q+$,J+q]]).translateExtent([[Q,-1/0],[Q+$,1/0]]).on("zoom",e=>{ef.current=e.transform.rescaleX(es),a.Ys(z.current).select("path").attr("d",ed(G.normalNodes,ef.current,ei)),a.Ys(F.current).select("path").attr("d",ed(G.significantNodes,ef.current,ei)),a.Ys(W.current).select("path").attr("d",ed(X.normalNodes,ef.current,ec)),a.Ys(Y.current).select("path").attr("d",ed(X.significantNodes,ef.current,ec)),a.Ys(E.current).selectAll("rect").attr("x",e=>ef.current(eu[e][0])).attr("width",e=>ef.current(eu[e][1])-ef.current(eu[e][0])),a.Ys(E.current).selectAll("text").attr("x",e=>(ef.current(eu[e][0])+ef.current(eu[e][1]))/2)});a.Ys(j.current).call(e)},[G.normalNodes,G.significantNodes,ei,ed,eu,X.normalNodes,X.significantNodes,ec,q,$,es,Q,J]),(0,i.useImperativeHandle)(t,()=>({downloadSvg:()=>{j.current&&(0,N.X)(j.current,"Focal_CNA_&_Gene.svg")}})),(0,r.jsxs)(l.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(l.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(o.Z,{isShowLeft:u,handleIsShowLeftChange:f,title:"Setting Options"})}),(0,r.jsxs)("svg",{width:x,height:y,ref:j,children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("clipPath",{id:"recurrent-regions-clip",children:(0,r.jsx)("rect",{x:Q,y:J,width:$,height:q})}),(0,r.jsx)("clipPath",{id:"chromosome-axis-clip",children:(0,r.jsx)("rect",{x:0,y:0,height:y,width:$})})]}),(0,r.jsxs)("g",{transform:"translate(".concat(s.chart.marginX,", ").concat(s.chart.marginY,")"),children:[(0,r.jsx)("g",{className:"title",children:(0,r.jsx)("text",{fontSize:s.title.fontSize,transform:"translate(".concat($/2,", ").concat(s.title.marginTop,")"),dy:"1em",fontWeight:500,textAnchor:"middle",children:"Focal CNA & Gene"})}),(0,r.jsxs)("g",{className:"figure",transform:"translate(".concat(Q,", ").concat(J,")"),children:[(0,r.jsx)("g",{ref:Z}),(0,r.jsx)("g",{ref:P}),(0,r.jsx)("g",{ref:E,transform:"translate(0, ".concat(en[0],")"),clipPath:"url(#chromosome-axis-clip)"}),(0,r.jsx)("g",{ref:z}),(0,r.jsx)("g",{ref:F}),(0,r.jsx)("g",{ref:W}),(0,r.jsx)("g",{ref:Y}),(0,r.jsx)("rect",{width:$,height:Math.abs(en[0]-en[1]),fill:"transparent",onPointerMove:e=>I(e,ef,G,O,n,"G-score",C,"Amp",b,en,g),onPointerLeave:()=>H(C,b)}),(0,r.jsx)("rect",{y:Math.abs(en[0]-en[1])+s.chromosomeAxis.height,width:$,height:Math.abs(er[0]-er[1]),fill:"transparent",onPointerMove:e=>I(e,ef,X,U,n,"G-score",C,"Del",b,er,g),onPointerLeave:()=>H(C,b)}),(0,r.jsx)("g",{ref:b})]})]})]}),(0,M.createPortal)((0,r.jsx)(L.Z,{ref:C}),document.body)]})}),I=(e,t,n,r,l,o,i,c,s,h,g)=>{let u,f,p;let m="hg19"===g?d.Bl:d.Kp,x=a.YFb(e=>e.x).right,y=a.YFb(e=>parseInt(e)).left,j=parseInt(t.current.invert(a.cx$(e)[0]));if("all"===l){let e=Object.keys(m),t=y(e,j);u=m[e[t]],f=0===t?j:j-parseInt(e[t-1])}else u=l,f=j;if(void 0===r.find(e=>e.chromosome===u&&e.start<=f&&e.end>=f)){let e=x(n.normalNodes,j)-1;p=n.normalNodes[e].y}else{let e=x(n.significantNodes,j)-1;p=n.significantNodes[e].y}a.Ys(s.current).selectAll("line").data([1]).join("line").attr("x1",t.current(j)).attr("x2",t.current(j)).attr("y1",h[0]).attr("y2",h[1]).attr("stroke-dasharray","5, 5").attr("stroke","black").attr("stroke-opacity",.3).style("pointer-events","none"),i.current.showTooltip(e,Z({chromosome:u,xPosition:f,valueType:o,value:p,type:c}))},H=(e,t)=>{e.current.hideTooltip(),a.Ys(t.current).selectAll("line").remove()};P.displayName="FocalCNAPlotPanel";var E=P},61546:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(85893),a=n(67294),l=n(33750),o=n(89073),i=n(13368),c=n(22904),s=n(34953),d=n(26163),h=n(43594),g=n(76709);let u=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(g._,{title:"Mode:",config:t,configKey:n,configSubKey:"mode",options:[{label:"Fixed",value:"Fixed"},{label:"Adaptive",value:"Adaptive"}],handleConfigChange:a}),"Fixed"===t.heatmap.mode?(0,r.jsx)(h.e,{title:"Rect Height:",config:t,configKey:n,configSubKey:"rectHeight",handleConfigChange:a}):(0,r.jsx)(h.e,{title:"Height:",config:t,configKey:n,configSubKey:"height",handleConfigChange:a})]})},f=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(h.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(h.e,{title:"Node Radius:",config:t,configKey:n,configSubKey:"nodeRadius",handleConfigChange:a})]})},p=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(h.e,{title:"Width:",config:t,configKey:n,configSubKey:"width",handleConfigChange:a}),(0,r.jsx)(h.e,{title:"Height:",config:t,configKey:n,configSubKey:"height",handleConfigChange:a})]})},m=(e,t)=>[{key:"tree",label:"Tree Basic Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(f,{config:e,configKey:"tree",handleConfigChange:t})},{key:"heatmap",label:"Tree Display Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(u,{config:e,configKey:"heatmap",handleConfigChange:t})},{key:"nodeHistory",label:"Node History Setting",extra:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(p,{config:e,configKey:"nodeHistory",handleConfigChange:t})}];var x=e=>{let{config:t,handleConfigChange:n}=e,[l,o]=(0,a.useState)(["heatmap","tree"]),d=(0,a.useMemo)(()=>m(t,n),[t,n]);return(0,r.jsxs)(i.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(c.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(s.Z,{items:d,activeKey:l,onChange:e=>{o(e)},size:"middle"})}),(0,r.jsx)(i.Z,{sx:{paddingTop:"12px"}})]})},y=n(69984),j=n(1657),v=n(78547),C=n(19792),b=n(73935),_=n(65420),w=n(11927),S=n(9040),A=n(96570);let R=(0,a.forwardRef)((e,t)=>{let{newick:n,config:l,isShowLeft:o,handleIsShowLeftChange:c,cluster:s=64}=e,{nodeHistoryList:d,currentNodeIndex:h,goBackNode:g,goForwardNode:u,goBackRoot:f,goToTreeNode:p}=(0,j.Z)(),m=(0,a.useRef)(null),x=(0,a.useRef)(null),R=(0,a.useRef)(null),k=(0,a.useMemo)(()=>(0,y.eC)(n),[n]).find(e=>e.data.name===d[h]),{nodes:Z,leaves:M,yMeta:L}=(0,y.cC)(k,s,l.tree,l.heatmap);return(0,a.useEffect)(()=>{let e=w.sPX().scaleExtent([.1,10]).on("zoom",function(e){w.Ys(x.current).attr("transform",e.transform)});w.Ys(m.current).call(e)},[]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{m.current&&(0,S.X)(m.current,"Phylogenetic_Tree.svg")}})),(0,r.jsxs)(i.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(i.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(C.Z,{isShowLeft:o,handleIsShowLeftChange:c,title:"Setting Options"})}),(0,r.jsx)("svg",{ref:m,width:"100%",height:"100%",children:(0,r.jsxs)("g",{ref:x,transform:"translate(100, 100)",children:[(0,r.jsx)("g",{className:"NodeHistory",transform:"translate(200, -50)",children:(0,r.jsx)(A.Z,{buttonWidth:l.nodeHistory.width,buttonHeight:l.nodeHistory.height,currentNodeIndex:h,nodeHistoryList:d,goBackRoot:f,goForwardNode:u,goBackNode:g})}),(0,r.jsx)(v.Z,{root:k,nodes:Z,leaves:M,goToTreeNode:p,settings:l.tree,showTooltip:(e,t)=>{R.current.showTooltip(e,t)},hideTooltip:()=>{R.current.hideTooltip()},isShowNodeCurve:!1})]})}),(0,b.createPortal)((0,r.jsx)(_.Z,{ref:R}),document.body)]})});R.displayName="PhylogeneticCutTreePanel";var k=e=>{let{meta:t,newick:n,vizRef:o}=e,[i,c]=(0,a.useState)(!0),[s,d]=(0,a.useState)({chart:{marginX:30,marginY:20},heatmap:{mode:"Adaptive",CNARectWidth:16,metaRectWidth:16,rectHeight:10,height:1e3},tree:{width:1e3,nodeRadius:4,marginToHeatmap:20},nodeHistory:{width:35,height:20}});return(0,r.jsx)(l.Z,{isShowLeft:i,leftPanelWidth:300,leftPanel:(0,r.jsx)(x,{config:s,handleConfigChange:(e,t,n)=>{d(r=>({...r,[e]:{...r[e],[t]:n}}))}}),rightPanel:(0,r.jsx)(R,{newick:n,config:s,isShowLeft:i,handleIsShowLeftChange:()=>{c(!i)},ref:o})})}},94665:function(e,t,n){n.d(t,{Z:function(){return C}});var r=n(85893),a=n(67294),l=n(33750),o=n(89073),i=n(13368),c=n(22904),s=n(34953),d=n(43594),h=n(26163);let g=e=>{let{config:t,configKey:n,handleConfigChange:a}=e;return(0,r.jsxs)(o.Z,{spacing:2,children:[(0,r.jsx)(d.e,{title:"Margin Top:",config:t,configKey:n,configSubKey:"marginTop",handleConfigChange:a}),(0,r.jsx)(d.e,{title:"Margin Bottom:",config:t,configKey:n,configSubKey:"marginBottom",handleConfigChange:a}),(0,r.jsx)(d.e,{title:"Margin Left:",config:t,configKey:n,configSubKey:"marginLeft",handleConfigChange:a}),(0,r.jsx)(d.e,{title:"Margin Right:",config:t,configKey:n,configSubKey:"marginRight",handleConfigChange:a})]})},u=(e,t)=>[{key:"chart",label:"Chart Setting",extra:(0,r.jsx)(h.Z,{}),children:(0,r.jsx)(g,{config:e,configKey:"chart",handleConfigChange:t})}];var f=e=>{let{config:t,handleConfigChange:n}=e,[l,o]=(0,a.useState)(["chart"]),d=(0,a.useMemo)(()=>u(t,n),[t,n]);return(0,r.jsxs)(i.Z,{sx:{paddingLeft:"12px",paddingTop:"12px",height:"920px",maxHeight:"920px"},children:[(0,r.jsx)(c.ZP,{theme:{components:{Collapse:{headerBg:"#FFFFFF",fontSize:"16px",headerPadding:"16px 16px"}}},children:(0,r.jsx)(s.Z,{items:d,activeKey:l,onChange:e=>{o(e)},size:"middle"})}),(0,r.jsx)(i.Z,{sx:{paddingTop:"12px"}})]})},p=n(73296),m=n(11927),x=n(19792),y=n(9040);let j=(e,t,n,r)=>{let a=e-n.chart.marginLeft-n.chart.marginRight,l=t-n.chart.marginTop-n.chart.marginBottom,o=45+n.chart.marginTop,i=[n.chart.marginLeft,n.chart.marginLeft+a],c=[n.chart.marginTop+o+(l-o),n.chart.marginTop+o],s=r.map(e=>e[0]),d=r.map(e=>e[1]),h=m.BYU().domain([Math.min(...s),Math.max(...s)]).range([i[0],i[1]]),g=m.BYU().domain([0,Math.ceil(Math.log10(Math.max(...d)))]).range([c[0],c[1]]);return{xRange:i,yRange:c,x:h,y:g,area:e=>m.SOn().x(e=>h(e[0])).y0(g(0)).y1(e=>g(0===e[1]?0:Math.log10(e[1])))(e)}},v=(0,a.forwardRef)((e,t)=>{let{distributions:n,config:l,isShowLeft:o,handleIsShowLeftChange:c}=e,{width:s,height:d}=(0,p.Oj)(),h=o?s-320:s-20,g=d-20,u=(0,a.useRef)(null),f=(0,a.useRef)(null),v=(0,a.useRef)(null),C=(0,a.useRef)(null),{xRange:b,yRange:_,x:w,y:S,area:A}=j(h,g,l,n);return(0,a.useEffect)(()=>{m.Ys(f.current).call(m.LLu(w).ticks((b[1]-b[0])/80))},[w,b]),(0,a.useEffect)(()=>{let e=m.Ys(v.current);e.selectAll(".tick .assist-line").remove(),e.call(m.y4O(S)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("class","assist-line").attr("x2",b[1]-b[0]).attr("stroke-opacity",.2).attr("stroke-dasharray","10, 10")),e.selectAll(".yAxis-label").data([1]).join("text").attr("x",-24).attr("y",_[1]-20).attr("text-anchor","start").attr("fill","black").attr("font-weight","bold").attr("class","yAxis-label").text("log10(Count)")},[b,S,_]),(0,a.useEffect)(()=>{m.Ys(C.current).selectAll("path").data([1]).join("path").attr("stroke","#1f77b4").attr("fill","#1f77b4").attr("d",A(n))},[A,n]),(0,a.useImperativeHandle)(t,()=>({downloadSvg:()=>{u.current&&(0,y.X)(u.current,"CNA_Ploidy_Distribution.svg")}})),(0,r.jsxs)(i.Z,{sx:{position:"relative",height:"920px"},children:[(0,r.jsx)(i.Z,{sx:{position:"absolute",top:"14px",left:"4px"},children:(0,r.jsx)(x.Z,{isShowLeft:o,handleIsShowLeftChange:c,title:"Setting Options"})}),(0,r.jsxs)("svg",{width:h,height:g,ref:u,children:[(0,r.jsx)("text",{fontSize:"24px",transform:"translate(".concat(h/2,", ").concat(l.chart.marginTop,")"),dy:"1rem",fontWeight:500,textAnchor:"middle",children:"CN Distribution"}),(0,r.jsx)("g",{ref:f,transform:"translate(0,".concat(_[0],")")}),(0,r.jsx)("g",{ref:v,transform:"translate(".concat(b[0],", 0)")}),(0,r.jsx)("g",{ref:C})]})]})});v.displayName="PloidyDistributionPanel";var C=e=>{let{distributions:t,vizRef:n}=e,[o,i]=(0,a.useState)(!0),[c,s]=(0,a.useState)({chart:{marginTop:50,marginBottom:50,marginLeft:30,marginRight:20},title:{fontSize:24,fontWeight:500}});return(0,r.jsx)(l.Z,{isShowLeft:o,leftPanelWidth:300,leftPanel:(0,r.jsx)(f,{config:c,handleConfigChange:(e,t,n)=>{s(r=>({...r,[e]:{...r[e],[t]:n}}))}}),rightPanel:(0,r.jsx)(v,{distributions:t,config:c,isShowLeft:o,handleIsShowLeftChange:()=>{i(!o)},ref:n})})}},43594:function(e,t,n){n.d(t,{e:function(){return i}});var r=n(85893),a=n(89073),l=n(13368),o=n(7489);let i=e=>{let{title:t,config:n,configKey:i,configSubKey:c,handleConfigChange:s,min:d=0,step:h=.1}=e;return(0,r.jsxs)(a.Z,{spacing:1,children:[(0,r.jsx)(l.Z,{sx:{fontWeight:500},children:t}),(0,r.jsx)(o.Z,{min:d,value:n[i][c],onChange:e=>{s(i,c,e)},size:"large",step:h,style:{width:"240px"}})]})}},76709:function(e,t,n){n.d(t,{_:function(){return i}});var r=n(85893),a=n(89073),l=n(13368),o=n(88265);let i=e=>{let{title:t,config:n,configKey:i,configSubKey:c,options:s,handleConfigChange:d}=e;return(0,r.jsxs)(a.Z,{spacing:1,children:[(0,r.jsx)(l.Z,{sx:{fontWeight:500},children:t}),(0,r.jsx)(o.ZP.Group,{block:!0,options:s,value:n[i][c],onChange:e=>{d(i,c,e.target.value)},optionType:"button",buttonStyle:"solid",style:{width:"240px"}})]})}},17028:function(e,t,n){n.d(t,{n:function(){return o},r:function(){return i}});var r=n(85893),a=n(11927),l=n(67294);let o=e=>{let{color:t,title:n,tickSize:o=6,width:i=320,height:c=44+o,marginTop:s=18,marginRight:d=0,marginBottom:h=16+o,marginLeft:g=0,ticks:u=i/64,legendMarginTop:f,tickFormat:p,tickValues:m}=e,x=(0,l.useRef)(null),y=(0,l.useRef)(p),j=(0,l.useRef)(m);function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=document.createElement("canvas");n.width=t,n.height=1;let r=n.getContext("2d");for(let n=0;n<t;++n)r.fillStyle=e(n/(t-1)),r.fillRect(n,0,1,1);return n}return(0,l.useEffect)(()=>{let e;let r=a.Ys(x.current);r.selectAll("*").remove(),r.attr("width",i).attr("height",c).style("overflow","visible").style("display","block");let l=e=>e.selectAll(".tick line").attr("y1",s+h-c);if(t.interpolate){let n=Math.min(t.domain().length,t.range().length);e=t.copy().rangeRound(a.q$2(a.sXR(g,i-d),n)),r.append("image").attr("x",g).attr("y",s).attr("width",i-g-d).attr("height",c-s-h).attr("preserveAspectRatio","none").attr("xlink:href",v(t.copy().domain(a.q$2(a.sXR(0,1),n))).toDataURL())}else if(t.interpolator){if(e=Object.assign(t.copy().interpolator(a.uLU(g,i-d)),{range:()=>[g,i-d]}),r.append("image").attr("x",g).attr("y",s).attr("width",i-g-d).attr("height",c-s-h).attr("preserveAspectRatio","none").attr("xlink:href",v(t.interpolator()).toDataURL()),!e.ticks){if(void 0===j.current){let e=Math.round(u+1);j.current=a.w6H(e).map(n=>a.VRg(t.domain(),n/(e-1)))}"function"!=typeof y.current&&(y.current=a.WUZ(void 0===y.current?",f":y.current))}}else if(t.invertExtent){let n=t.thresholds?t.thresholds():t.quantiles?t.quantiles():t.domain(),l=void 0===p?e=>e:"string"==typeof p?a.WUZ(p):p;e=a.BYU().domain([-1,t.range().length-1]).rangeRound([g,i-d]),r.append("g").selectAll("rect").data(t.range()).join("rect").attr("x",(t,n)=>e(n-1)).attr("y",s).attr("width",(t,n)=>e(n)-e(n-1)).attr("height",c-s-h).attr("fill",e=>e),j.current=a.w6H(n.length),y.current=e=>l(n[e],e)}else e=a.tiA().domain(t.domain()).rangeRound([g,i-d]),r.append("g").selectAll("rect").data(t.domain()).join("rect").attr("x",e).attr("y",s).attr("width",Math.max(0,e.bandwidth()-1)).attr("height",c-s-h).attr("fill",t),l=()=>{};r.append("g").attr("transform","translate(0,".concat(c-h,")")).call(a.LLu(e).ticks(u,"string"==typeof p?p:void 0).tickFormat("function"==typeof p?p:void 0).tickSize(o).tickValues(m)).call(l).call(e=>e.select(".domain").remove()).call(e=>e.append("text").attr("x",g).attr("y",s+h-c-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(n))},[t,c,h,g,d,s,p,o,m,u,n,i]),(0,r.jsx)("g",{ref:x,transform:"translate(0, ".concat(f,")")})},i=e=>{let{color:t,title:n,tickSize:o=6,width:i=44+o,height:c=320,marginTop:s=30,marginRight:d=4,marginBottom:h=0,marginLeft:g=18+o,ticks:u=c/64,legendMarginTop:f,tickFormat:p,tickValues:m}=e,x=(0,l.useRef)(null),y=(0,l.useRef)(p),j=(0,l.useRef)(m);function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=document.createElement("canvas");n.width=1,n.height=t;let r=n.getContext("2d");for(let n=0;n<t;++n)r.fillStyle=e(n/(t-1)),r.fillRect(0,t-1-n,1,1);return n}return(0,l.useEffect)(()=>{let e;let r=a.Ys(x.current);r.selectAll("*").remove(),r.attr("width",i).attr("height",c).style("overflow","visible").style("display","block");let l=e=>e.selectAll(".tick line").attr("x1",i-d-g);if(t.interpolate){let n=Math.min(t.domain().length,t.range().length);e=t.copy().rangeRound(a.q$2(a.sXR(c-h,s),n)),r.append("image").attr("x",g).attr("y",s).attr("width",i-g-d).attr("height",c-s-h).attr("preserveAspectRatio","none").attr("xlink:href",v(t.copy().domain(a.q$2(a.sXR(0,1),n))).toDataURL())}else if(t.interpolator){if(e=Object.assign(t.copy().interpolator(a.uLU(s,c-h)),{range:()=>[s,c-h]}),r.append("image").attr("x",g).attr("y",s).attr("width",i-g-d).attr("height",c-s-h).attr("preserveAspectRatio","none").attr("xlink:href",v(t.interpolator()).toDataURL()),!e.ticks){if(void 0===j.current){let e=Math.round(u+1);j.current=a.w6H(e).map(n=>a.VRg(t.domain(),n/(e-1)))}"function"!=typeof y.current&&(y.current=a.WUZ(void 0===y.current?",f":y.current))}}else if(t.invertExtent){let n=t.thresholds?t.thresholds():t.quantiles?t.quantiles():t.domain(),l=void 0===p?e=>e:"string"==typeof p?a.WUZ(p):p;e=a.BYU().domain([-1,t.range().length-1]).rangeRound([s,c-h]),r.append("g").selectAll("rect").data(t.range()).join("rect").attr("x",(t,n)=>e(n-1)).attr("y",s).attr("height",(t,n)=>e(n)-e(n-1)).attr("width",i-g-d).attr("fill",e=>e),j.current=a.w6H(n.length),y.current=e=>l(n[e],e)}else e=a.tiA().domain(t.domain()).rangeRound([s,c-s]),r.append("g").selectAll("rect").data(t.domain()).join("rect").attr("x",g).attr("y",e).attr("width",i-g-d).attr("height",Math.max(0,e.bandwidth()-1)).attr("fill",t),l=()=>{};r.append("g").attr("transform","translate(".concat(g,", 0)")).call(a.y4O(e).ticks(u,"string"==typeof p?p:void 0).tickFormat("function"==typeof p?p:void 0).tickSize(o).tickValues(m)).call(l).call(e=>e.select(".domain").remove()).call(e=>e.append("text").attr("x",-i/2).attr("y",s-15).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(n))},[t,c,h,g,d,s,p,o,m,u,n,i]),(0,r.jsx)("g",{ref:x,transform:"translate(0, ".concat(f,")")})}},2755:function(e,t,n){n.d(t,{Z:function(){return j}});var r=n(85893),a=n(85417),l=n(13368),o=n(31816),i=n(45114),c=n(89073),s=n(4),d=n(57980);let h=[{title:"ID",dataIndex:"id",sorter:(e,t)=>e.id.toLowerCase().localeCompare(t.id.toLowerCase()),fixed:"left",align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})}],g=[{title:"Sample ID",dataIndex:"id",sorter:(e,t)=>e.id.toLowerCase().localeCompare(t.id.toLowerCase()),fixed:"left",align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})},{title:"Disease Type",dataIndex:"c_disease_type",sorter:(e,t)=>{let n=(e.c_disease_type||"").toLowerCase(),r=(t.c_disease_type||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>(0,r.jsx)(c.Z,{sx:{alignItems:"center"},children:(0,r.jsx)(s.Z,{text:e||"--"})})},{title:"Primary Site",dataIndex:"c_primiary_site",sorter:(e,t)=>{let n=(e.c_primiary_site||"").toLowerCase(),r=(t.c_primiary_site||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>(0,r.jsx)(s.Z,{text:e||"--"})},{title:"Tumor Stage",dataIndex:"c_tumor_stage",sorter:(e,t)=>{let n=(e.c_tumor_stage||"").toLowerCase(),r=(t.c_tumor_stage||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Tumor Grade",dataIndex:"c_tumor_grade",sorter:(e,t)=>{let n=(e.c_tumor_grade||"").toLowerCase(),r=(t.c_tumor_grade||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Ethnicity",dataIndex:"c_ethinicity",sorter:(e,t)=>{let n=(e.c_ethinicity||"").toLowerCase(),r=(t.c_ethinicity||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>(0,r.jsx)(s.Z,{text:e||"--"})},{title:"Race",dataIndex:"c_race",sorter:(e,t)=>{let n=(e.c_race||"").toLowerCase(),r=(t.c_race||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>(0,r.jsx)(s.Z,{text:e||"--"})},{title:"Gender",dataIndex:"c_gender",sorter:(e,t)=>{let n=(e.c_gender||"").toLowerCase(),r=(t.c_gender||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Age",dataIndex:"n_age",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_age)&&void 0!==n?n:0)-(null!==(r=t.n_age)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"PFS",dataIndex:"n_pfs",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_pfs)&&void 0!==n?n:0)-(null!==(r=t.n_pfs)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Days To Death",dataIndex:"n_os",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_os)&&void 0!==n?n:0)-(null!==(r=t.n_os)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"PFS Status",dataIndex:"c_pfs_status",align:"center"},{title:"Vital Status",dataIndex:"c_os_status",align:"center"}],u=e=>"10x Official"===e?[{title:"Cell ID",dataIndex:"id",sorter:(e,t)=>e.id.toLowerCase().localeCompare(t.id.toLowerCase()),fixed:"left",align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})},{title:"Total Num Reads",dataIndex:"c_total_num_reads",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_total_num_reads)&&void 0!==n?n:0)-(null!==(r=t.c_total_num_reads)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Num UnMapped Reads",dataIndex:"c_num_unmapped_reads",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_num_unmapped_reads)&&void 0!==n?n:0)-(null!==(r=t.c_num_unmapped_reads)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Num Lowmapq Reads",dataIndex:"c_num_lowmapq_reads",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_num_lowmapq_reads)&&void 0!==n?n:0)-(null!==(r=t.c_num_lowmapq_reads)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Num Duplicate Reads",dataIndex:"c_num_duplicate_reads",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_num_duplicate_reads)&&void 0!==n?n:0)-(null!==(r=t.c_num_duplicate_reads)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Num Mapped Dedup Reads",dataIndex:"c_num_mapped_dedup_reads",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_num_mapped_dedup_reads)&&void 0!==n?n:0)-(null!==(r=t.c_num_mapped_dedup_reads)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Fraction Mapped Duplicates",dataIndex:"c_frac_mapped_duplicates",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_frac_mapped_duplicates)&&void 0!==n?n:0)-(null!==(r=t.c_frac_mapped_duplicates)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Effective Depth of Coverage",dataIndex:"c_effective_depth_of_coverage",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_effective_depth_of_coverage)&&void 0!==n?n:0)-(null!==(r=t.c_effective_depth_of_coverage)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Effective Reads per 1Mbp",dataIndex:"c_effective_reads_per_1Mbp",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_effective_reads_per_1Mbp)&&void 0!==n?n:0)-(null!==(r=t.c_effective_reads_per_1Mbp)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Raw MapD",dataIndex:"c_raw_mapd",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_raw_mapd)&&void 0!==n?n:0)-(null!==(r=t.c_raw_mapd)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Normalized MapD",dataIndex:"c_normalized_mapd",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_normalized_mapd)&&void 0!==n?n:0)-(null!==(r=t.c_normalized_mapd)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Raw DimapD",dataIndex:"c_raw_dimapd",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_raw_dimapd)&&void 0!==n?n:0)-(null!==(r=t.c_raw_dimapd)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Normalized DimapD",dataIndex:"c_normalized_dimapd",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_normalized_dimapd)&&void 0!==n?n:0)-(null!==(r=t.c_normalized_dimapd)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Mean Ploidy",dataIndex:"c_mean_ploidy",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_mean_ploidy)&&void 0!==n?n:0)-(null!==(r=t.c_mean_ploidy)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Ploidy Confidence",dataIndex:"c_ploidy_confidence",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_ploidy_confidence)&&void 0!==n?n:0)-(null!==(r=t.c_ploidy_confidence)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Is High DimapD",dataIndex:"n_is_high_dimapd",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_is_high_dimapd)&&void 0!==n?n:0)-(null!==(r=t.n_is_high_dimapd)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Is Noisy",dataIndex:"n_is_noisy",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_is_noisy)&&void 0!==n?n:0)-(null!==(r=t.n_is_noisy)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Estimated CNV Resolution (MB)",dataIndex:"c_est_cnv_resolution_mb",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_est_cnv_resolution_mb)&&void 0!==n?n:0)-(null!==(r=t.c_est_cnv_resolution_mb)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"}]:[{title:"Cell ID",dataIndex:"id",sorter:(e,t)=>e.id.toLowerCase().localeCompare(t.id.toLowerCase()),align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})},{title:"Cell Type",dataIndex:"c_cell_type",sorter:(e,t)=>{let n=(e.c_cell_type||"").toLowerCase(),r=(t.c_cell_type||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Confidence",dataIndex:"c_confidence",sorter:(e,t)=>{var n,r;return(null!==(n=e.c_confidence)&&void 0!==n?n:0)-(null!==(r=t.c_confidence)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"Donor",dataIndex:"c_donor",sorter:(e,t)=>{let n=(e.c_donor||"").toLowerCase(),r=(t.c_donor||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"CNV Score",dataIndex:"n_cnv_score",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_cnv_score)&&void 0!==n?n:0)-(null!==(r=t.n_cnv_score)&&void 0!==r?r:0)},align:"center",render:e=>e||"--"},{title:"CNV Status",dataIndex:"c_cnv_status",sorter:(e,t)=>{let n=(e.c_cnv_status||"").toLowerCase(),r=(t.c_cnv_status||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Malignancy",dataIndex:"c_malignancy",sorter:(e,t)=>{let n=(e.c_malignancy||"").toLowerCase(),r=(t.c_malignancy||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Cell Label",dataIndex:"c_cell_label",sorter:(e,t)=>{let n=(e.c_cell_label||"").toLowerCase(),r=(t.c_cell_label||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"}],f=[{title:"Cell ID",dataIndex:"id",sorter:(e,t)=>{var n,r;return null===(r=e.id)||void 0===r?void 0:r.toLowerCase().localeCompare(null===(n=t.id)||void 0===n?void 0:n.toLowerCase())},fixed:"left",align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})},{title:"Cell Type",dataIndex:"c_cell_type",sorter:(e,t)=>{let n=(e.c_cell_type||"").toLowerCase(),r=(t.c_cell_type||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Confidence",dataIndex:"c_confidence",sorter:(e,t)=>{let n=(e.c_confidence||"").toLowerCase(),r=(t.c_confidence||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Donor",dataIndex:"c_donor",sorter:(e,t)=>{let n=(e.c_donor||"").toLowerCase(),r=(t.c_donor||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"CNV Score",dataIndex:"n_cnv_score",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_cnv_score)&&void 0!==n?n:-1/0)-(null!==(r=t.n_cnv_score)&&void 0!==r?r:-1/0)},align:"center",render:e=>null!=e?e:"--"},{title:"CNV Status",dataIndex:"c_cnv_status",sorter:(e,t)=>{let n=(e.c_cnv_status||"").toLowerCase(),r=(t.c_cnv_status||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Malignancy",dataIndex:"c_malignancy",sorter:(e,t)=>{let n=(e.c_malignancy||"").toLowerCase(),r=(t.c_malignancy||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Cell Label",dataIndex:"c_cell_label",sorter:(e,t)=>{let n=(e.c_cell_label||"").toLowerCase(),r=(t.c_cell_label||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"}],p=[{title:"Spot ID",dataIndex:"id",sorter:(e,t)=>{var n,r;return null===(r=e.id)||void 0===r?void 0:r.toLowerCase().localeCompare(null===(n=t.id)||void 0===n?void 0:n.toLowerCase())},fixed:"left",align:"center",render:e=>(0,r.jsx)(i.Z,{value:e,color:"volcano"})},{title:"Cell Type",dataIndex:"c_cell_type",sorter:(e,t)=>{let n=(e.c_cell_type||"").toLowerCase(),r=(t.c_cell_type||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Confidence",dataIndex:"c_confidence",sorter:(e,t)=>{let n=(e.c_confidence||"").toLowerCase(),r=(t.c_confidence||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Donor",dataIndex:"c_donor",sorter:(e,t)=>{let n=(e.c_donor||"").toLowerCase(),r=(t.c_donor||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"CNV Score",dataIndex:"n_cnv_score",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_cnv_score)&&void 0!==n?n:-1/0)-(null!==(r=t.n_cnv_score)&&void 0!==r?r:-1/0)},align:"center",render:e=>null!=e?e:"--"},{title:"CNV Status",dataIndex:"c_cnv_status",sorter:(e,t)=>{let n=(e.c_cnv_status||"").toLowerCase(),r=(t.c_cnv_status||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Malignancy",dataIndex:"c_malignancy",sorter:(e,t)=>{let n=(e.c_malignancy||"").toLowerCase(),r=(t.c_malignancy||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Cell Label",dataIndex:"c_cell_label",sorter:(e,t)=>{let n=(e.c_cell_label||"").toLowerCase(),r=(t.c_cell_label||"").toLowerCase();return n.localeCompare(r)},align:"center",render:e=>e||"--"},{title:"Spatial 1",dataIndex:"n_spatial1",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_spatial1)&&void 0!==n?n:-1/0)-(null!==(r=t.n_spatial1)&&void 0!==r?r:-1/0)},align:"center",render:e=>null!=e?e:"--"},{title:"Spatial 2",dataIndex:"n_spatial2",sorter:(e,t)=>{var n,r;return(null!==(n=e.n_spatial2)&&void 0!==n?n:-1/0)-(null!==(r=t.n_spatial2)&&void 0!==r?r:-1/0)},align:"center",render:e=>null!=e?e:"--"}],m=e=>e?"bulkDNA"===e.modality?g:"scDNA"===e.modality?u(e.source):"scRNA"===e.modality?f:"ST"===e.modality?p:void 0:h;var x=e=>{let{dataset:t,data:n}=e,a=m(t);return(0,r.jsx)(d.k,{columns:a,rowKey:e=>e.id,dataSource:n,scroll:{x:"max-content"}})};let y=(e,t,n)=>{let a=[];for(let l=1;l<=e;l++)a.push({label:"Cluster ".concat(l),key:"Cluster ".concat(l),children:(0,r.jsx)(x,{dataset:t,data:n.filter(e=>e.cluster===l)})});return a};var j=e=>{let{dataset:t,cluster:n,meta:i,isModalOpen:c,handleModalCancel:s}=e,d=y(n,t,i);return(0,r.jsx)(a.Z,{titleContent:(0,r.jsx)(l.Z,{sx:{fontWeight:"500",fontSize:"28px",pointerEvents:"none"},children:"Cluster Info"}),open:c,onCancel:s,footer:[],width:1450,centered:!0,children:(0,r.jsx)(o.Z,{tabBarStyle:{marginLeft:"16px"},items:d})})}},77225:function(e,t,n){n.d(t,{R6:function(){return c},X9:function(){return i},xE:function(){return o}});var r=n(85893),a=n(96486),l=n.n(a);n(67294);let o=(e,t,n,a)=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:e}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{display:"inline-block",marginRight:4,borderRadius:10,width:10,height:10,backgroundColor:t}}),(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:n}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:"string"==typeof a?a:l().round(a,3)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),i=e=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:e}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),c=(e,t,n,a)=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:e}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"Parent Node:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:t}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"Number of CNV Files:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:n}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"Distance to Root:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:l().round(a,3)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})},58557:function(e,t,n){n.d(t,{C:function(){return i},d:function(){return o}});var r=n(85893),a=n(96486),l=n.n(a);n(67294);let o=(e,t,n)=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:e}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{display:"inline-block",marginRight:4,borderRadius:10,width:10,height:10,backgroundColor:n}}),(0,r.jsxs)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:[l().round(t[0],5),", ",l().round(t[1],5)]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),i=(e,t,n)=>(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0px 0 0",lineHeight:1},children:[(0,r.jsx)("div",{style:{fontSize:18,textAlign:"center",color:"#666",fontWeight:800,lineHeight:"1.5"},children:e}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"x:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:l().round(t[0],5)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"y:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:l().round(t[1],5)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsxs)("div",{style:{margin:"10px 0 0",lineHeight:1},children:[(0,r.jsxs)("div",{style:{margin:"0 0 0",lineHeight:1},children:[(0,r.jsx)("span",{style:{fontSize:14,color:"#666",fontWeight:400,marginLeft:2},children:"CNA Value:"}),(0,r.jsx)("span",{style:{float:"right",marginLeft:20,fontSize:14,color:"#666",fontWeight:900},children:l().round(n,3)}),(0,r.jsx)("div",{style:{clear:"both"}})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})]}),(0,r.jsx)("div",{style:{clear:"both"}})]})},65420:function(e,t,n){var r=n(85893),a=n(67294);let l=(0,a.forwardRef)(function(e,t){let[n,l]=(0,a.useState)({visible:!1,x:0,y:0,content:null});return(0,a.useImperativeHandle)(t,()=>({showTooltip:(e,t)=>{l({visible:!0,x:e.pageX,y:e.pageY,content:t})},hideTooltip:()=>{l({...n,visible:!1})}})),(0,r.jsxs)("div",{style:{position:"absolute",top:n.y-5,left:n.x,zIndex:1e3,display:n.visible?"block":"none",borderStyle:"solid",whiteSpace:"nowrap",boxShadow:"rgba(0, 0, 0, 0.2) 1px 2px 10px",backgroundColor:"rgb(255, 255, 255)",borderWidth:"1px",borderRadius:"4px",color:"rgb(102, 102, 102)",font:'14px / 21px "Microsoft YaHei"',padding:"10px",borderColor:"rgb(84, 112, 198)",pointerEvents:"none",transform:"translate(-50%, -100%)"},children:[n.content,(0,r.jsx)("div",{style:{position:"absolute",width:6,height:6,zIndex:-1,left:"50%",bottom:"-4.21px",transform:"translateX(-50%) rotate(225deg)",borderTop:"rgb(84, 112, 198) solid 1px",borderLeft:"rgb(84, 112, 198) solid 1px",backgroundColor:"#fff"}})]})});t.Z=l},1657:function(e,t,n){var r=n(67294);t.Z=()=>{let[e,t]=(0,r.useState)(["n0"]),[n,a]=(0,r.useState)(0);return{nodeHistoryList:e,currentNodeIndex:n,goBackNode:()=>{n>0&&a(n-1)},goForwardNode:()=>{n<e.length-1&&a(n+1)},goBackRoot:()=>{t(["n0"]),a(0)},goToTreeNode:r=>{t([...e.slice(0,n+1),r]),a(n+1)}}}},69984:function(e,t,n){n.d(t,{Au:function(){return j},FB:function(){return d},Qo:function(){return _},SE:function(){return b},UH:function(){return v},Y9:function(){return C},cC:function(){return h},eC:function(){return c},w6:function(){return y}});var r=n(11927),a=n(96486),l=n.n(a),o=n(10858),i=n(98400);let c=e=>{let t=r.bT9((0,i.Z)(e),e=>e.children).sum(e=>e.children?0:1),n=0;return t.each(e=>{e.data.name||(e.data.name="n".concat(n++))}),r.ki8().nodeSize([10,10])(t),t.data.length=0,s(t),t},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.data.distanceToRoot=t+e.data.length,e.children&&e.children.forEach(t=>{s(t,e.data.distanceToRoot)})},d=(e,t,n,a,l,o,i,c)=>{let{middles:s,leaves:d}=p(e,t),h=[],m={};for(let e of d){let t=e.leaves().map(e=>e.data.name);h.push(...t),m[e.data.name]=t}let x=c.metaRectWidth*a.length,y="Fixed"===c.mode?c.rectHeight*h.length:c.height,j=c.CNARectWidth*l.length,v=r.tiA().domain(h).range([0,y]),C=r.tiA().domain(a).range([0,x]),b=Object.fromEntries(Object.entries(n).filter(e=>{let[t,n]=e;return h.includes(t)}));f(e,s,d,m,i.width,v);let _=r.tiA().domain(l.map(e=>e.gene)).range([x,j+x]),w=g(d);return{nodes:[...s,...d],leaves:d,yMeta:v,xMeta:C,filteredMeta:b,xMatrix:_,yMatrix:w,cutTreeCNVMatrix:u(o,m)}},h=(e,t,n,a)=>{let{middles:l,leaves:o}=p(e,t),i=[],c={};for(let e of o){let t=e.leaves().map(e=>e.data.name);i.push(...t),c[e.data.name]=t}let s="Fixed"===a.mode?a.rectHeight*i.length:a.height,d=r.tiA().domain(i).range([0,s]);return f(e,l,o,c,n.width,d),{nodes:[...l,...o],leaves:o,yMeta:d}},g=e=>e.reduce((e,t)=>(e[t.data.name]={y:t.topX,height:t.bottomX-t.topX},e),{}),u=(e,t)=>Object.entries(t).reduce((t,n)=>{let[r,a]=n,o=a.map(t=>e[t]);return t[r]=l().zipWith(...o,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>e+t,0)/t.length}),t},{}),f=(e,t,n,r,a,o)=>{for(let e of n){let t=r[e.data.name];e.topX=o(l().head(t)),e.bottomX=o(l().last(t))+o.bandwidth(),e.horizontalPosition=(e.topX+e.bottomX)/2}for(let e of t)e.horizontalPosition=(e.children[0].horizontalPosition+e.children[1].horizontalPosition)/2;let i=m(e,n);x(e,-e.data.length,0===i?1:a/i,n)},p=(e,t)=>{let n=[],r=new o.lF((e,t)=>e.data.distanceToRoot-t.data.distanceToRoot);for(r.push(e);r.length!==t;){let e=r.pop();if(n.push(e),r.push(...e.children),void 0===r.peek().children)break}return{middles:n.reverse(),leaves:r.toArray().sort((e,t)=>t.x-e.x)}},m=(e,t)=>e.data.length+(t.includes(e)?0:r.Fp7(e.children,e=>m(e,t))),x=(e,t,n,r)=>{e.verticalPosition=(t+=e.data.length)*n,r.includes(e)||e.children.forEach(e=>x(e,t,n,r))},y=e=>e.data.length+(e.children?r.Fp7(e.children,y):0),j=(e,t,n)=>{e.verticalPosition=(t+=e.data.length)*n,e.children&&e.children.forEach(e=>{j(e,t,n)})},v=e=>"M ".concat(e.source.verticalPosition," ").concat(e.source.x," V ").concat(e.target.x," H ").concat(e.target.verticalPosition),C=e=>"translate(".concat(e.verticalPosition,", ").concat(e.x,")"),b=e=>"M ".concat(e.source.verticalPosition," ").concat(e.source.horizontalPosition," V ").concat(e.target.horizontalPosition," H ").concat(e.target.verticalPosition),_=e=>"translate(".concat(e.verticalPosition,", ").concat(e.horizontalPosition,")")},75757:function(e,t,n){n.d(t,{A7:function(){return f},Bl:function(){return h},Gk:function(){return d},Ht:function(){return r},Kp:function(){return l},OE:function(){return p},OW:function(){return s},Sp:function(){return o},cB:function(){return c},en:function(){return u},oD:function(){return y},qF:function(){return i},sV:function(){return a},x9:function(){return g}});let r={chr1:248956422,chr2:242193529,chr3:198295559,chr4:190214555,chr5:181538259,chr6:170805979,chr7:159345973,chr8:145138636,chr9:138394717,chr10:133797422,chr11:135086622,chr12:133275309,chr13:114364328,chr14:107043718,chr15:101991189,chr16:90338345,chr17:83257441,chr18:80373285,chr19:58617616,chr20:64444167,chr21:46709983,chr22:50818468,chrX:156040895,chrY:57227415},a={chr1:0,chr2:248956422,chr3:491149951,chr4:689445510,chr5:879660065,chr6:1061198324,chr7:1232004303,chr8:1391350276,chr9:1536488912,chr10:1674883629,chr11:1808681051,chr12:1943767673,chr13:2077042982,chr14:2191407310,chr15:2298451028,chr16:2400442217,chr17:2490780562,chr18:2574038003,chr19:2654411288,chr20:2713028904,chr21:2777473071,chr22:2824183054,chrX:2875001522,chrY:3031042417},l={248956422:"chr1",491149951:"chr2",689445510:"chr3",879660065:"chr4",1061198324:"chr5",1232004303:"chr6",1391350276:"chr7",1536488912:"chr8",1674883629:"chr9",1808681051:"chr10",1943767673:"chr11",2077042982:"chr12",2191407310:"chr13",2298451028:"chr14",2400442217:"chr15",2490780562:"chr16",2574038003:"chr17",2654411288:"chr18",2713028904:"chr19",2777473071:"chr20",2824183054:"chr21",2875001522:"chr22",3031042417:"chrX",3088269832:"chrY"},o={chr1:[0,248956422],chr2:[248956422,491149951],chr3:[491149951,689445510],chr4:[689445510,879660065],chr5:[879660065,1061198324],chr6:[1061198324,1232004303],chr7:[1232004303,1391350276],chr8:[1391350276,1536488912],chr9:[1536488912,1674883629],chr10:[1674883629,1808681051],chr11:[1808681051,1943767673],chr12:[1943767673,2077042982],chr13:[2077042982,2191407310],chr14:[2191407310,2298451028],chr15:[2298451028,2400442217],chr16:[2400442217,2490780562],chr17:[2490780562,2574038003],chr18:[2574038003,2654411288],chr19:[2654411288,2713028904],chr20:[2713028904,2777473071],chr21:[2777473071,2824183054],chr22:[2824183054,2875001522],chrX:[2875001522,3031042417],chrY:[3031042417,3088269832]},i=[1,3088269832],c=[1,2875001522],s={chr1:249250621,chr2:243199373,chr3:198022430,chr4:191154276,chr5:180915260,chr6:171115067,chr7:159138663,chr8:146364022,chr9:141213431,chr10:135534747,chr11:135006516,chr12:133851895,chr13:115169878,chr14:107349540,chr15:102531392,chr16:90354753,chr17:81195210,chr18:78077248,chr19:59128983,chr20:63025520,chr21:48129895,chr22:51304566,chrX:155270560,chrY:59373566},d={chr1:0,chr2:249250621,chr3:492449994,chr4:690472424,chr5:881626700,chr6:1062541960,chr7:1233657027,chr8:1392795690,chr9:1539159712,chr10:1680373143,chr11:1815907890,chr12:1950914406,chr13:2084766301,chr14:2199936179,chr15:2307285719,chr16:2409817111,chr17:2500171864,chr18:2581367074,chr19:2659444322,chr20:2718573305,chr21:2781598825,chr22:2829728720,chrX:2881033286,chrY:3036303846},h={249250621:"chr1",492449994:"chr2",690472424:"chr3",881626700:"chr4",1062541960:"chr5",1233657027:"chr6",1392795690:"chr7",1539159712:"chr8",1680373143:"chr9",1815907890:"chr10",1950914406:"chr11",2084766301:"chr12",2199936179:"chr13",2307285719:"chr14",2409817111:"chr15",2500171864:"chr16",2581367074:"chr17",2659444322:"chr18",2718573305:"chr19",2781598825:"chr20",2829728720:"chr21",2881033286:"chr22",3036303846:"chrX",3095677412:"chrY"},g={chr1:[0,249250621],chr2:[249250621,492449994],chr3:[492449994,690472424],chr4:[690472424,881626700],chr5:[881626700,1062541960],chr6:[1062541960,1233657027],chr7:[1233657027,1392795690],chr8:[1392795690,1539159712],chr9:[1539159712,1680373143],chr10:[1680373143,1815907890],chr11:[1815907890,1950914406],chr12:[1950914406,2084766301],chr13:[2084766301,2199936179],chr14:[2199936179,2307285719],chr15:[2307285719,2409817111],chr16:[2409817111,2500171864],chr17:[2500171864,2581367074],chr18:[2581367074,2659444322],chr19:[2659444322,2718573305],chr20:[2718573305,2781598825],chr21:[2781598825,2829728720],chr22:[2829728720,2881033286],chrX:[2881033286,3036303846],chrY:[3036303846,3095677412]},u=[1,3095677412],f=[1,2881033286],p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hg38",n=[];for(let[a,l]of Object.entries("hg19"===t?s:r)){let t=Math.floor(l/e)+1;n.push([a,t])}return n},m=e=>e.replace("chr",""),x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m,n=t(e);return isNaN(n)?"X"===n?23:"Y"===n?24:void 0:parseInt(n,10)},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return"desc"===e?(e,n)=>x(n,t)-x(e,t):(e,n)=>x(e,t)-x(n,t)}},9040:function(e,t,n){n.d(t,{X:function(){return r}});function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"download.svg",n=new Blob([new XMLSerializer().serializeToString(e)],{type:"image/svg+xml;charset=utf-8"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=t,a.click(),URL.revokeObjectURL(r)}},21333:function(e,t,n){n.d(t,{$R:function(){return c},Bu:function(){return d},Rr:function(){return p},fP:function(){return m},jU:function(){return o},lY:function(){return i},ph:function(){return y},vK:function(){return x},yX:function(){return s}});var r=n(11927),a=n(10858),l=n(69984);let o=(e,t,n)=>{let a=e-16,l=a-2*n.chart.margin,o=n.title.marginTop+n.title.marginBottom+Math.ceil(1.31*n.title.fontSize),i=l-o-n.chart.axisWidth,c=Math.floor(i/(n.legend.height+n.legend.itemVerticalGap)),s=Math.ceil(t/c),d=i+n.chart.axisWidth+(s-1)*n.legend.itemHorizontalGap+s*n.legend.width+n.legend.marginLeft,h=d+2*n.chart.margin,g=n.chart.axisWidth,u=n.chart.axisWidth+i+n.legend.marginLeft,f=1===s?o+(i-n.legend.height*t-n.legend.itemVerticalGap*(t-1))/2:o+(i-n.legend.height*c-n.legend.itemVerticalGap*(c-1))/2;return{svgWidth:h,svgHeight:a,innerWidth:d,figureSize:i,rowLegendNum:c,xOffsetScatterPlot:g,yOffsetScatterPlot:o,yOffsetXAxis:o+i,xOffsetLegend:u,yOffsetLegend:f,xRange:[0,i],yRange:[i,0],colorScale:r.PKp(r.Cn1)}},i=(e,t,n)=>{let a=e-16,l=a-2*t.chart.margin,o=t.title.marginTop+t.title.marginBottom+Math.ceil(1.31*t.title.fontSize)+Math.ceil(1.31*t.title.subFontSize)+10,i=t.title.marginTop+Math.ceil(1.31*t.title.fontSize)+10,c=l-o-t.chart.axisWidth,s=c+t.chart.axisWidth+40+t.legend.marginLeft,d=s+2*t.chart.margin,h=t.chart.axisWidth,g=t.chart.axisWidth+c+t.legend.marginLeft,u=n?[-1,0,1]:[0,2,10],f=r.PUr(u,["#add8e6","#e0e0e0","#6A0220"]);return{svgWidth:d,svgHeight:a,innerWidth:s,figureSize:c,subTitleMarginTop:i,xOffsetScatterPlot:h,yOffsetScatterPlot:o,yOffsetXAxis:o+c,xOffsetLegend:g,yOffsetLegend:o+(c-320)/2,xRange:[0,c],yRange:[c,0],CNARange:u,CNAValueScale:f}},c=(e,t)=>{let n=[Math.min(t["".concat(e,"1")].min,t["".concat(e,"2")].min),Math.max(t["".concat(e,"1")].max,t["".concat(e,"2")].max)];return[Math.floor(10*n[0]-1)/10,Math.ceil(10*n[1]+1)/10]},s=(e,t,n)=>({x:r.BYU().domain(e).range(t),y:r.BYU().domain(e).range(n)}),d=(e,t)=>{let n=(0,l.eC)(e);if(n.leaves().length<t)return null;let r=new a.lF((e,t)=>e.data.distanceToRoot-t.data.distanceToRoot);for(r.push(n);r.length!==t;){let e=r.pop();if(r.push(...e.children),void 0===r.peek().children)break}return r.toArray().sort((e,t)=>t.x-e.x).map((e,t)=>[t+1,e.leaves().map(e=>e.data.name)])},h=[{label:"PCA",value:"e_PCA"},{label:"TSNE",value:"e_TSNE"},{label:"UMAP",value:"e_UMAP"},{label:"NMF",value:"e_NMF"},{label:"ICA",value:"e_ICA"},{label:"PHATE",value:"e_PHATE"},{label:"Spatial",value:"n_spatial"}],g=e=>{let t=[];return h.forEach(n=>{e.some(e=>e.startsWith(n.value))&&t.push(n)}),t},u=e=>/n_spatial_\d+/.test(e)?e.replace("n_spatial_","n_spatial"):e,f=e=>{let t={};for(let n in e){let r=e[n],a=u(n),l=+r;isNaN(l)||(r=l),t[a]=r}return t},p=e=>{let t=r.ueB(e,f),n=g(t.columns),a=n.flatMap(e=>["".concat(e.value,"1"),"".concat(e.value,"2")]),l=Object.fromEntries(a.map(e=>[e,{min:1/0,max:-1/0}]));for(let e of t)for(let t of a){let n=e[t];Number.isFinite(n)&&(n<l[t].min&&(l[t].min=n),n>l[t].max&&(l[t].max=n))}for(let e of a)l[e].min===1/0&&(l[e]={min:null,max:null});return{parsedMeta:t,embeddingMethods:n.filter(e=>"n_spatial"!==e.value),extents:l}},m=(e,t,n)=>{let r=d(t,n);if(!r)return[];let a=new Map;return r.forEach(e=>{let[t,n]=e;n.forEach(e=>{a.set(e,t)})}),e.map(e=>{let t=a.get(e.id)||null;return{...e,cluster:t}})},x=e=>{let t=[],n=[],r=[];for(let a of e)"Bin"===a.Type?t.push({value:a.id,variance:a.Variance}):"Gene"===a.Type?n.push({value:a.id,variance:a.Variance}):"Term"===a.Type&&r.push({value:a.id,variance:a.Variance});return{binOptions:t,geneOptions:n,termOptions:r}},y=e=>{let t=[],n=[],r=[];for(let a of e)"Bin"===a.Type?t.push({value:a.id,moranI:a["Moran I"]}):"Gene"===a.Type?n.push({value:a.id,moranI:a["Moran I"]}):"Term"===a.Type&&r.push({value:a.id,moranI:a["Moran I"]});return{binOptions:t,geneOptions:n,termOptions:r}}},66710:function(e,t,n){n.d(t,{Z:function(){return a},y:function(){return i}});var r=n(11927);let a=(e,t,n)=>{let a=r.ueB(e,r.rA8),i={...o(l(t,a))};return{processedMeta:s(a,n),colorScales:i}},l=(e,t)=>{let n={};return e.forEach(e=>{let r=t.map(t=>t[e]);n[e]={min:Math.min(...r),max:Math.max(...r)}}),n},o=e=>{let t=r.BYU().domain([e.e_PCA1.min,e.e_PCA1.max]).range(["#c4a1d3","#ad49e1"]),n=r.BYU().domain([e.e_PCA2.min,e.e_PCA2.max]).range(["#52b199","#0d7c66"]),a=r.BYU().domain([e.e_TSNE1.min,e.e_TSNE2.max]).range(["#d88f92","#c63c51"]);return{e_PCA1:t,e_PCA2:n,e_TSNE1:a,e_TSNE2:r.BYU().domain([e.e_TSNE2.min,e.e_TSNE2.max]).range(["#bad9ff","#3572ef"]),e_UMAP1:r.BYU().domain([e.e_UMAP1.min,e.e_UMAP1.max]).range(["#ffa699","#ff7f3e"]),e_UMAP2:r.BYU().domain([e.e_UMAP2.min,e.e_UMAP2.max]).range(["#f0e8fa","#FF76CE"])}},i=(e,t,n)=>{let a=r.ueB(e,r.rA8),l=c(n);return{processedMatrix:s(a,t.map(e=>e.gene)),CNVColorScale:l}},c=e=>{let t=r.BYU().domain(2===e?[0,2]:[-1,0]).range(["#add8e6","#ffffff"]).clamp(!0),n=r.BYU().domain(2===e?[2,10]:[0,1]).range(["#ffffff","#6A0220"]).clamp(!0);return e=>e<2?t(e):n(e)},s=(e,t)=>e.reduce((e,n)=>(e[n.id]=t.map(e=>n[e]),e),{})},98400:function(e,t){t.Z=e=>{for(var t=[],n={},r=e.split(/\s*(;|\(|\)|,|:)\s*/),a=0;a<r.length;a++){var l=r[a];switch(l){case"(":var o={};n.children=[o],t.push(n),n=o;break;case",":var o={};t[t.length-1].children.push(o),n=o;break;case")":n=t.pop();break;case":":break;default:var i=r[a-1];")"===i||"("===i||","===i?n.name=l:":"===i&&(n.length=parseFloat(l))}}return n}},33750:function(e,t,n){var r=n(85893),a=n(10996);t.Z=e=>{let{isShowLeft:t,leftPanel:n,rightPanel:l,leftPanelWidth:o=280}=e;return(0,r.jsxs)(a.Z,{onResize:e=>{},children:[(0,r.jsx)(a.Z.Panel,{style:{paddingRight:t?"12px":0},size:t?o:0,children:t?n:null}),(0,r.jsx)(a.Z.Panel,{style:{paddingLeft:"12px"},resizable:!1,children:l})]})}},45114:function(e,t,n){var r=n(85893),a=n(21550);t.Z=e=>{let{value:t,color:n,style:l}=e;return(0,r.jsx)(a.Z,{style:{borderRadius:"20px",padding:"2px 8px",cursor:"default",...l},color:n,children:t})}},99897:function(e,t,n){var r=n(85893),a=n(73296);t.Z=e=>{let{children:t}=e;return(0,r.jsx)(a.ZP,{containerSx:{minHeight:"920px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)",overflowX:"auto",scrollbarColor:"#eaeaea transparent","&::-webkit-scrollbar":{height:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#eaeaea",borderRadius:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"}},children:t})}},57980:function(e,t,n){n.d(t,{k:function(){return l}});var r=n(97834),a=n(38304);let l=(0,r.Z)(a.Z)({"& .ant-table":{"& .ant-table-container":{"& .ant-table-body, & .ant-table-content":{scrollbarColor:"#eaeaea transparent"}}}})},91499:function(e,t,n){var r=n(87066),a=n(35955);let l=r.Z.create({baseURL:a.Sg,timeout:6e4,headers:{"Content-Type":"application/json"}});t.Z=l},35955:function(e,t,n){n.d(t,{Sg:function(){return r},Vl:function(){return a},l:function(){return l}});let r="https://cna.fengslab.com/api",a=r+"/database",l=r+"/analysis"},18244:function(e,t,n){n.d(t,{$V:function(){return s},$t:function(){return S},Fv:function(){return A},L_:function(){return w},N0:function(){return c},OG:function(){return u},Ok:function(){return _},QJ:function(){return b},U$:function(){return y},WQ:function(){return C},ae:function(){return a},f4:function(){return R},gS:function(){return h},gy:function(){return v},h8:function(){return p},kH:function(){return d},ks:function(){return j},l$:function(){return g},l4:function(){return x},sN:function(){return o},tj:function(){return i},u4:function(){return f},vS:function(){return m},xW:function(){return l}});var r=n(35955);let a=e=>{let t=document.createElement("a");t.href=e,t.click()},l=()=>"".concat(r.Vl,"/datasets/"),o=e=>"".concat(r.Vl,"/download_dataset/?dataset_name=").concat(e),i=e=>"".concat(r.Vl,"/datasets/").concat(encodeURIComponent(e),"/"),c=e=>"".concat(r.Vl,"/samples/?dataset_name=").concat(encodeURIComponent(e)),s=(e,t,n)=>"".concat(r.Vl,"/CNA_matrix/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),d=()=>"".concat(r.Vl,"/CNA_vector/"),h=(e,t,n)=>"".concat(r.Vl,"/CNA_meta/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),g=(e,t,n)=>"".concat(r.Vl,"/CNA_tree/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),u=(e,t,n)=>"".concat(r.Vl,"/CNA_genes/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),f=(e,t,n)=>"".concat(r.Vl,"/CNA_newick/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),p=()=>"".concat(r.Vl,"/CNA_gene_matrix/"),m=(e,t,n)=>"".concat(r.Vl,"/CNA_terms/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),x=()=>"".concat(r.Vl,"/CNA_term_matrix/"),y=e=>"".concat(r.Vl,"/focal_CNA_options/?dataset_name=").concat(encodeURIComponent(e)),j=(e,t,n)=>"".concat(r.Vl,"/focal_CNA_info/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(n),"&cn_type=").concat(encodeURIComponent(t)),v=(e,t,n)=>"".concat(r.Vl,"/ploidy_distribution/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),C=(e,t,n)=>"".concat(r.Vl,"/top_cn_variance/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),b=(e,t,n)=>"".concat(r.Vl,"/spatial_top_cn_variance/?dataset_name=").concat(encodeURIComponent(e),"&workflow_type=").concat(encodeURIComponent(t),"&bin_size=").concat(encodeURIComponent(n)),_=e=>"".concat(r.Vl,"/consensus_focal_gene/?dataset_name=").concat(encodeURIComponent(e)),w=e=>"".concat(r.Vl,"/consensus_gene/?dataset_name=").concat(encodeURIComponent(e)),S=e=>"".concat(r.Vl,"/consensus_gene_download/?dataset_name=").concat(encodeURIComponent(e)),A=e=>"".concat(r.Vl,"/pathway_enrichment_options/?dataset_name=").concat(encodeURIComponent(e)),R=(e,t,n)=>"".concat(r.Vl,"/pathway_enrichment_plot/?dataset_name=").concat(encodeURIComponent(e),"&cn_type=").concat(encodeURIComponent(t),"&workflow=").concat(encodeURIComponent(n))},38106:function(e,t,n){n.d(t,{_:function(){return a}});var r=n(91499);let a=async e=>{try{return(await r.Z.get(e)).data}catch(r){var t,n;let e=Error("An error occurred while fetching the data.");throw e.info=(null===(t=r.response)||void 0===t?void 0:t.data)||{},e.status=null===(n=r.response)||void 0===n?void 0:n.status,e}}}}]);